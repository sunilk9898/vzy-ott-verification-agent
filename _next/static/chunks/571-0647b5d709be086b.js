"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[571],{94022:function(e,t,n){n.d(t,{R:function(){return d}});var r=n(57437),s=n(2265),a=n(40875),c=n(10407),o=n(96362),i=n(95080),l=n(93448);function d(e){let{finding:t,onCreateJira:n}=e,[d,x]=(0,s.useState)(!1);return(0,r.jsxs)("div",{className:"border-b border-white/[0.04] last:border-0",children:[(0,r.jsxs)("button",{onClick:()=>x(!d),className:"w-full flex items-center gap-3 px-4 py-3 text-left hover:bg-white/[0.02] transition-colors",children:[d?(0,r.jsx)(a.Z,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}):(0,r.jsx)(c.Z,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),(0,r.jsx)("span",{className:(0,l.cn)("badge flex-shrink-0",(0,l.pK)(t.severity)),children:t.severity.toUpperCase()}),(0,r.jsx)("span",{className:"text-sm text-gray-200 truncate flex-1",children:t.title}),(0,r.jsx)("span",{className:"text-xs text-gray-500 flex-shrink-0",children:t.category}),t.jiraTicketId&&(0,r.jsx)("span",{className:"text-xs text-brand-400 flex-shrink-0",children:t.jiraTicketId}),t.autoFixable&&(0,r.jsx)("span",{className:"badge bg-cyan-500/15 text-cyan-400 border-cyan-500/30 flex-shrink-0",children:"Auto-fix"})]}),d&&(0,r.jsxs)("div",{className:"px-12 pb-4 space-y-3 animate-fade-up",children:[(0,r.jsx)("p",{className:"text-sm text-gray-300",children:t.description}),t.evidence&&(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-xs font-medium text-gray-500 mb-1",children:"Evidence"}),(0,r.jsx)("pre",{className:"text-xs text-gray-400 bg-surface-1 p-3 rounded-lg overflow-x-auto font-mono",children:t.evidence})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-xs font-medium text-gray-500 mb-1",children:"Remediation"}),(0,r.jsx)("p",{className:"text-sm text-gray-300",children:t.remediation})]}),t.location&&(0,r.jsxs)("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[t.location.file&&(0,r.jsxs)("span",{children:["File: ",(0,l.$G)(t.location.file,60)]}),t.location.line&&(0,r.jsxs)("span",{children:["Line: ",t.location.line]}),t.location.url&&(0,r.jsxs)("span",{children:["URL: ",(0,l.$G)(t.location.url,60)]}),t.location.endpoint&&(0,r.jsxs)("span",{children:["Endpoint: ",t.location.endpoint]})]}),(t.cweId||t.cvssScore)&&(0,r.jsxs)("div",{className:"flex items-center gap-4 text-xs",children:[t.cweId&&(0,r.jsx)("span",{className:"text-gray-400",children:t.cweId}),t.cvssScore&&(0,r.jsxs)("span",{className:(0,l.cn)("font-medium",t.cvssScore>=9?"text-red-400":t.cvssScore>=7?"text-orange-400":"text-amber-400"),children:["CVSS: ",t.cvssScore]})]}),t.references.length>0&&(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:t.references.map((e,t)=>(0,r.jsxs)("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-xs text-brand-400 hover:text-brand-300",children:[(0,r.jsx)(o.Z,{className:"w-3 h-3"})," Reference ",t+1]},t))}),(0,r.jsx)("div",{className:"flex items-center gap-2 pt-2 border-t border-white/[0.04]",children:!t.jiraTicketId&&n&&(0,r.jsxs)("button",{onClick:()=>n(t.id),className:"btn-secondary text-xs py-1.5",children:[(0,r.jsx)(i.Z,{className:"w-3.5 h-3.5"}),"Create Jira Ticket"]})})]})]})}},67437:function(e,t,n){n.d(t,{i:function(){return c}});var r=n(57437),s=n(93448),a=n(10407);function c(e){let{label:t,value:n,subtitle:c,icon:o,trend:i,status:l="neutral",className:d,onClick:x}=e,u=!!x,f=u?"button":"div";return(0,r.jsxs)(f,{onClick:x,className:(0,s.cn)("card p-4 animate-fade-up text-left w-full",u&&"cursor-pointer hover:bg-white/[0.04] hover:border-brand-500/30 transition-all group",d),children:[(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsx)("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:t}),(0,r.jsx)("div",{className:(0,s.cn)("text-2xl font-bold mt-1 tabular-nums","good"===l&&"text-green-400","warn"===l&&"text-amber-400","bad"===l&&"text-red-400","neutral"===l&&"text-gray-100"),children:n}),c&&(0,r.jsx)("div",{className:"text-xs text-gray-500 mt-0.5",children:c})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[o&&(0,r.jsx)("div",{className:(0,s.cn)("p-2 rounded-lg","good"===l&&"bg-green-500/10 text-green-400","warn"===l&&"bg-amber-500/10 text-amber-400","bad"===l&&"bg-red-500/10 text-red-400","neutral"===l&&"bg-white/[0.04] text-gray-400"),children:(0,r.jsx)(o,{className:"w-4 h-4"})}),u&&(0,r.jsx)(a.Z,{className:"w-3.5 h-3.5 text-gray-600 group-hover:text-brand-400 transition-colors"})]})]}),i&&(0,r.jsxs)("div",{className:"mt-3 pt-3 border-t border-white/[0.04] flex items-center gap-1.5",children:[(0,r.jsxs)("span",{className:(0,s.cn)("text-xs font-semibold",i.delta>0?"text-green-400":i.delta<0?"text-red-400":"text-gray-500"),children:[i.delta>0?"+":"",i.delta]}),(0,r.jsx)("span",{className:"text-xs text-gray-500",children:i.label})]}),u&&(0,r.jsx)("div",{className:"mt-2 text-[10px] text-gray-600 group-hover:text-gray-400 transition-colors",children:"Click for details"})]})}},29761:function(e,t,n){n.d(t,{O:function(){return o}});var r=n(57437),s=n(2265),a=n(93448);let c={sm:{width:80,stroke:6,fontSize:"text-lg",labelSize:"text-[10px]"},md:{width:120,stroke:8,fontSize:"text-2xl",labelSize:"text-xs"},lg:{width:180,stroke:10,fontSize:"text-4xl",labelSize:"text-sm"},xl:{width:240,stroke:12,fontSize:"text-5xl",labelSize:"text-base"}};function o(e){let{score:t,label:n,size:o="lg",showStatus:i=!0,animate:l=!0}=e,[d,x]=(0,s.useState)(l?0:t),u=c[o],f=(u.width-u.stroke)/2,h=2*Math.PI*f,g=(0,a.Uc)(t);(0,s.useEffect)(()=>{let e;if(!l){x(t);return}let n=performance.now(),r=s=>{let a=Math.min((s-n)/1200,1);x(Math.round(0+(t-0)*(1-Math.pow(1-a,3)))),a<1&&(e=requestAnimationFrame(r))};return e=requestAnimationFrame(r),()=>cancelAnimationFrame(e)},[t,l]);let m="gauge-gradient-".concat(o,"-").concat(t);return(0,r.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,r.jsxs)("div",{className:"relative",style:{width:u.width,height:u.width},children:[(0,r.jsxs)("svg",{viewBox:"0 0 ".concat(u.width," ").concat(u.width),className:"transform -rotate-90",children:[(0,r.jsx)("defs",{children:(0,r.jsx)("linearGradient",{id:m,x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:t>=95?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("stop",{offset:"0%",stopColor:"#22c55e"}),(0,r.jsx)("stop",{offset:"100%",stopColor:"#4ade80"})]}):t>=80?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("stop",{offset:"0%",stopColor:"#f59e0b"}),(0,r.jsx)("stop",{offset:"100%",stopColor:"#fbbf24"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("stop",{offset:"0%",stopColor:"#ef4444"}),(0,r.jsx)("stop",{offset:"100%",stopColor:"#f87171"})]})})}),(0,r.jsx)("circle",{cx:u.width/2,cy:u.width/2,r:f,fill:"none",stroke:"rgba(255,255,255,0.06)",strokeWidth:u.stroke}),(0,r.jsx)("circle",{cx:u.width/2,cy:u.width/2,r:f,fill:"none",stroke:"url(#".concat(m,")"),strokeWidth:u.stroke,strokeLinecap:"round",strokeDasharray:h,strokeDashoffset:h-d/100*h,className:"gauge-ring"})]}),(0,r.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[(0,r.jsx)("span",{className:(0,a.cn)("font-bold tabular-nums",u.fontSize,(0,a.Uz)(t)),children:d}),n&&(0,r.jsx)("span",{className:(0,a.cn)("text-gray-400 font-medium",u.labelSize),children:n})]})]}),i&&(0,r.jsxs)("div",{className:(0,a.cn)("badge","healthy"===g&&"bg-green-500/15 text-green-400 border-green-500/30","warning"===g&&"bg-amber-500/15 text-amber-400 border-amber-500/30","critical"===g&&"bg-red-500/15 text-red-400 border-red-500/30"),children:[(0,r.jsx)("span",{className:(0,a.cn)("w-1.5 h-1.5 rounded-full","healthy"===g&&"bg-green-400","warning"===g&&"bg-amber-400","critical"===g&&"bg-red-400 animate-pulse")}),"healthy"===g?"Healthy":"warning"===g?"Warning":"Critical"]})]})}},44481:function(e,t,n){n.d(t,{w:function(){return o}});var r=n(2265),s=n(92371),a=n(71837),c=n(79286);function o(){let{report:e,target:t,loading:n,error:o,setReport:i,setTarget:l,setLoading:d,setError:x}=(0,s.nq)(),{activeScan:u,setActiveScan:f,completeScan:h}=(0,s.rG)(),g=(0,r.useCallback)(async()=>{if(t){d(!0);try{let e=await (0,a.IK)(t);i(e)}catch(e){x(e.message)}}},[t,i,d,x]),m=(0,r.useCallback)(async e=>{d(!0);try{let t=await (0,a.lZ)(e);return f({scanId:t.scanId,status:"running",agents:{security:{progress:0,status:"queued"},performance:{progress:0,status:"queued"},"code-quality":{progress:0,status:"queued"},"report-generator":{progress:0,status:"queued"}},startedAt:new Date().toISOString()}),t}catch(e){throw x(e.message),e}},[f,d,x]);(0,r.useEffect)(()=>{let e=(0,c.gN)(e=>{h(e.scanId,e.score,e.status),g()}),t=(0,c.DF)(()=>{f(null),d(!1)});return()=>{e(),t()}},[h,f,g,d]);let p=(null==e?void 0:e.agentResults.find(e=>"security"===e.agentType))||null,b=(null==e?void 0:e.agentResults.find(e=>"performance"===e.agentType))||null,j=(null==e?void 0:e.agentResults.find(e=>"code-quality"===e.agentType))||null,w=((null==e?void 0:e.agentResults.flatMap(e=>e.findings))||[]).reduce((e,t)=>(e[t.severity]=(e[t.severity]||0)+1,e),{});return{report:e,target:t,loading:n,error:o,activeScan:u,securityResult:p,performanceResult:b,codeQualityResult:j,findingsBySeverity:w,setTarget:l,startScan:m,refresh:g}}},93448:function(e,t,n){n.d(t,{$G:function(){return u},Sy:function(){return x},Uc:function(){return c},Uz:function(){return o},cn:function(){return a},dH:function(){return d},pK:function(){return i},td:function(){return l}});var r=n(61994),s=n(53335);function a(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,s.m6)((0,r.W)(t))}function c(e){return e>=95?"healthy":e>=80?"warning":"critical"}function o(e){return e>=95?"text-kpi-pass":e>=80?"text-kpi-warn":"text-kpi-fail"}function i(e){return({critical:"bg-red-500/15 text-red-400 border-red-500/30",high:"bg-orange-500/15 text-orange-400 border-orange-500/30",medium:"bg-amber-500/15 text-amber-400 border-amber-500/30",low:"bg-blue-500/15 text-blue-400 border-blue-500/30",info:"bg-gray-500/15 text-gray-400 border-gray-500/30"})[e]}function l(e){if(0===e)return"0 B";let t=Math.floor(Math.log(e)/Math.log(1024));return"".concat(parseFloat((e/Math.pow(1024,t)).toFixed(1))," ").concat(["B","KB","MB","GB"][t])}function d(e){return e<1e3?"".concat(Math.round(e),"ms"):"".concat((e/1e3).toFixed(1),"s")}function x(e){let t="string"==typeof e?new Date(e):e,n=Math.floor((Date.now()-t.getTime())/6e4);if(n<1)return"just now";if(n<60)return"".concat(n,"m ago");let r=Math.floor(n/60);return r<24?"".concat(r,"h ago"):"".concat(Math.floor(r/24),"d ago")}function u(e,t){return e.length<=t?e:e.slice(0,t)+"..."}},79286:function(e,t,n){n.d(t,{$j:function(){return o},DF:function(){return d},H0:function(){return x},WH:function(){return u},gN:function(){return l},zP:function(){return i}});var r=n(68680);let s=n(40257).env.WS_URL||"https://vzy-api-gro1.onrender.com",a=null,c={"scan:progress":new Set,"scan:complete":new Set,"scan:error":new Set,"batch:progress":new Set,"batch:complete":new Set};function o(){return(null==a?void 0:a.connected)||((a=(0,r.io)(s,{transports:["websocket","polling"],reconnection:!0,reconnectionDelay:2e3,reconnectionAttempts:10,auth:{token:localStorage.getItem("vzy_token")}})).on("connect",()=>{console.info("[WS] Connected:",null==a?void 0:a.id)}),a.on("disconnect",e=>{console.warn("[WS] Disconnected:",e)}),a.on("scan:progress",e=>{c["scan:progress"].forEach(t=>t(e))}),a.on("scan:complete",e=>{c["scan:complete"].forEach(t=>t(e))}),a.on("scan:error",e=>{c["scan:error"].forEach(t=>t(e))}),a.on("batch:progress",e=>{c["batch:progress"].forEach(t=>t(e))}),a.on("batch:complete",e=>{c["batch:complete"].forEach(t=>t(e))})),a}function i(){null==a||a.disconnect(),a=null}function l(e){return c["scan:complete"].add(e),()=>{c["scan:complete"].delete(e)}}function d(e){return c["scan:error"].add(e),()=>{c["scan:error"].delete(e)}}function x(e){return c["batch:progress"].add(e),()=>{c["batch:progress"].delete(e)}}function u(e){return c["batch:complete"].add(e),()=>{c["batch:complete"].delete(e)}}}}]);