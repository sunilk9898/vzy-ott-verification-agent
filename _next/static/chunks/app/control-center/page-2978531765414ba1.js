(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[48],{72894:function(e,t,n){Promise.resolve().then(n.bind(n,20360))},76858:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});let s=(0,n(79205).Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},94766:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});let s=(0,n(79205).Z)("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]])},92934:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});let s=(0,n(79205).Z)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},61641:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});let s=(0,n(79205).Z)("CircleStop",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{width:"6",height:"6",x:"9",y:"9",key:"1wrtvo"}]])},99388:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});let s=(0,n(79205).Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},29202:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});let s=(0,n(79205).Z)("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]])},51817:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});let s=(0,n(79205).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},82431:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});let s=(0,n(79205).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},10866:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});let s=(0,n(79205).Z)("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]])},95080:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});let s=(0,n(79205).Z)("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]])},32489:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});let s=(0,n(79205).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},20360:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return M}});var s=n(57437),a=n(2265),r=n(10866),c=n(33276),i=n(91723),l=n(94766),o=n(79205);let d=(0,o.Z)("Webhook",[["path",{d:"M18 16.98h-5.99c-1.1 0-1.95.94-2.48 1.9A4 4 0 0 1 2 17c.01-.7.2-1.4.57-2",key:"q3hayz"}],["path",{d:"m6 17 3.13-5.78c.53-.97.1-2.18-.5-3.1a4 4 0 1 1 6.89-4.06",key:"1go1hn"}],["path",{d:"m12 6 3.13 5.73C15.66 12.7 16.9 13 18 13a4 4 0 0 1 0 8",key:"qlwsc0"}]]);var u=n(51817),h=n(61641),x=n(7586),m=n(92934),f=n(99388),g=n(76858);let p=(0,o.Z)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),y=(0,o.Z)("Slack",[["rect",{width:"3",height:"8",x:"13",y:"2",rx:"1.5",key:"diqz80"}],["path",{d:"M19 8.5V10h1.5A1.5 1.5 0 1 0 19 8.5",key:"183iwg"}],["rect",{width:"3",height:"8",x:"8",y:"14",rx:"1.5",key:"hqg7r1"}],["path",{d:"M5 15.5V14H3.5A1.5 1.5 0 1 0 5 15.5",key:"76g71w"}],["rect",{width:"8",height:"3",x:"14",y:"13",rx:"1.5",key:"1kmz0a"}],["path",{d:"M15.5 19H14v1.5a1.5 1.5 0 1 0 1.5-1.5",key:"jc4sz0"}],["rect",{width:"8",height:"3",x:"2",y:"8",rx:"1.5",key:"1omvl4"}],["path",{d:"M8.5 5H10V3.5A1.5 1.5 0 1 0 8.5 5",key:"16f3cl"}]]),b=(0,o.Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);var j=n(95080),v=n(82431),N=n(60864),k=n(44481),w=n(92371),S=n(71837),Z=n(79286),C=n(93448);function M(){let{startScan:e,loading:t,activeScan:n,target:o,setTarget:M}=(0,k.w)(),{user:z}=(0,w.tN)(),{scanHistory:I,setActiveScan:T}=(0,w.rG)(),{batchId:A,batchScans:E,batchRunning:q,startBatch:O,updateBatchEntry:R,clearBatch:H}=(0,w.eX)(),[P,B]=(0,a.useState)(null),[D,F]=(0,a.useState)([]),[_,U]=(0,a.useState)(null),[J,L]=(0,a.useState)(!1),[K,W]=(0,a.useState)(!1),[X,Q]=(0,a.useState)("scan"),G=async e=>{M(e);try{let t=await (0,S.IK)(e);w.nq.getState().setReport(t)}catch(t){console.warn("Failed to load report for",e,t.message)}},V=async()=>{if(n){W(!0);try{await (0,S.bx)(n.scanId)}catch(e){console.warn("Backend abort failed â€” clearing local scan state")}T(null),W(!1)}},$=async e=>{try{let t=await (0,S.FX)(e);O(t.batchId,t.scans.map(e=>({url:e.url,scanId:e.scanId})))}catch(e){alert("Batch scan failed: ".concat(e.message))}};(0,a.useEffect)(()=>{let e=(0,Z.H0)(e=>{R(e.scanId,{status:e.status,score:e.score,error:e.error}),"completed"===e.status&&e.url&&!w.nq.getState().target&&G(e.url)}),t=(0,Z.WH)(()=>{w.eX.setState({batchRunning:!1});let e=w.eX.getState().batchScans.find(e=>"completed"===e.status);e&&!w.nq.getState().target&&G(e.url)});return()=>{e(),t()}},[R]),(0,a.useEffect)(()=>{(0,S.iE)().then(B).catch(()=>{}),(0,S.Qx)().then(U).catch(()=>{}),(0,S.hO)(20).then(F).catch(()=>{})},[]);let Y=async()=>{if(P){L(!0);try{let e=await (0,S.rF)(P);B(e)}catch(e){alert("Failed to save configuration")}L(!1)}};if(z&&!["admin","devops"].includes(z.role))return(0,s.jsx)("div",{className:"flex items-center justify-center h-[60vh]",children:(0,s.jsxs)("div",{className:"text-center text-gray-500 space-y-2",children:[(0,s.jsx)(r.Z,{className:"w-12 h-12 mx-auto opacity-30"}),(0,s.jsx)("p",{className:"text-sm",children:"Access restricted to Admin and DevOps roles."})]})});let ee=E.filter(e=>"completed"===e.status).length,et=E.filter(e=>"error"===e.status).length,en=E.length,es=[{id:"scan",label:"Run Scan",icon:c.Z},{id:"schedule",label:"Schedule",icon:i.Z},{id:"thresholds",label:"KPI Thresholds",icon:r.Z},{id:"notifications",label:"Notifications",icon:l.Z},{id:"webhooks",label:"Webhook Logs",icon:d}];return(0,s.jsxs)("div",{className:"space-y-6 max-w-[1200px] mx-auto",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-xl font-bold text-gray-100",children:"Control Center"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Scan management, scheduling, configuration, and integrations"})]}),_&&(0,s.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-lg bg-green-500/[0.06] border border-green-500/20",children:[(0,s.jsx)("div",{className:"status-dot-healthy"}),(0,s.jsx)("span",{className:"text-xs text-green-400",children:"System Online"}),(0,s.jsxs)("span",{className:"text-xs text-gray-500 ml-2",children:["Uptime: ",Math.floor((_.uptime||0)/3600),"h"]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-12 gap-6",children:[(0,s.jsx)("div",{className:"col-span-12 md:col-span-3",children:(0,s.jsx)("nav",{className:"space-y-1",children:es.map(e=>{let t=e.icon;return(0,s.jsxs)("button",{onClick:()=>Q(e.id),className:(0,C.cn)("w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm text-left transition-colors",X===e.id?"bg-brand-600/15 text-brand-400":"text-gray-400 hover:bg-white/[0.04] hover:text-gray-200"),children:[(0,s.jsx)(t,{className:"w-4 h-4"})," ",e.label]},e.id)})})}),(0,s.jsxs)("div",{className:"col-span-12 md:col-span-9 space-y-6",children:["scan"===X&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(N.l,{onSubmit:t=>e(t),onBatchSubmit:$,loading:t||q}),n&&(0,s.jsxs)("div",{className:"card p-5 space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(u.Z,{className:"w-4 h-4 text-brand-400 animate-spin"}),(0,s.jsx)("span",{className:"text-sm font-medium text-brand-400",children:"Scan in Progress"}),(0,s.jsx)("span",{className:"text-xs text-gray-500",children:n.scanId})]}),(0,s.jsxs)("button",{onClick:V,disabled:K,className:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-red-500/10 border border-red-500/30 text-red-400 text-xs font-medium hover:bg-red-500/20 transition-colors disabled:opacity-50",children:[K?(0,s.jsx)(u.Z,{className:"w-3.5 h-3.5 animate-spin"}):(0,s.jsx)(h.Z,{className:"w-3.5 h-3.5"}),K?"Aborting...":"Abort Scan"]})]}),(0,s.jsx)("div",{className:"grid grid-cols-3 gap-3",children:Object.entries(n.agents).map(e=>{let[t,n]=e;return(0,s.jsxs)("div",{className:"p-3 rounded-lg bg-surface-1 text-center",children:[(0,s.jsx)("div",{className:"text-xs text-gray-400 capitalize",children:t}),(0,s.jsx)("div",{className:(0,C.cn)("text-sm font-medium mt-1","completed"===n.status?"text-green-400":"running"===n.status?"text-brand-400":"text-gray-500"),children:"completed"===n.status?"Done":"running"===n.status?"".concat(n.progress,"%"):"Queued"})]},t)})})]}),E.length>0&&(0,s.jsxs)("div",{className:"card",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between px-5 py-4 border-b border-white/[0.06]",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[q?(0,s.jsx)(u.Z,{className:"w-4 h-4 text-brand-400 animate-spin"}):(0,s.jsx)(x.Z,{className:"w-4 h-4 text-brand-400"}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"text-sm font-semibold text-gray-200",children:["Batch Scan ",q?"in Progress":"Complete"]}),(0,s.jsxs)("p",{className:"text-[10px] text-gray-500 mt-0.5",children:[ee,"/",en," completed",et>0&&" \xb7 ".concat(et," failed")]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-32 h-1.5 bg-surface-4 rounded-full overflow-hidden",children:(0,s.jsx)("div",{className:"h-full bg-brand-500 rounded-full transition-all duration-500",style:{width:"".concat(en>0?(ee+et)/en*100:0,"%")}})}),!q&&(0,s.jsx)("button",{onClick:H,className:"text-xs text-gray-500 hover:text-gray-300 transition-colors",children:"Clear"})]})]}),(0,s.jsx)("div",{className:"divide-y divide-white/[0.04] max-h-[400px] overflow-y-auto",children:E.map((e,t)=>{let n="completed"===e.status,a=o===e.url;return(0,s.jsxs)("div",{onClick:()=>n&&G(e.url),className:(0,C.cn)("px-5 py-3 flex items-center justify-between transition-colors",n&&"cursor-pointer hover:bg-white/[0.04]",a&&"bg-brand-600/10 border-l-2 border-brand-500"),children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[(0,s.jsxs)("span",{className:"text-[10px] text-gray-600 w-5 text-right shrink-0",children:[t+1,"."]}),"completed"===e.status?(0,s.jsx)(m.Z,{className:"w-4 h-4 text-green-400 shrink-0"}):"running"===e.status?(0,s.jsx)(u.Z,{className:"w-4 h-4 text-brand-400 animate-spin shrink-0"}):"error"===e.status?(0,s.jsx)(f.Z,{className:"w-4 h-4 text-red-400 shrink-0"}):(0,s.jsx)(i.Z,{className:"w-4 h-4 text-gray-500 shrink-0"}),(0,s.jsx)("span",{className:"text-xs text-gray-300 truncate",children:e.url}),a&&(0,s.jsx)("span",{className:"text-[9px] text-brand-400 font-medium ml-1",children:"Active"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3 shrink-0 ml-3",children:[void 0!==e.score&&(0,s.jsx)("span",{className:(0,C.cn)("text-sm font-bold",e.score>=95?"text-green-400":e.score>=70?"text-amber-400":"text-red-400"),children:e.score}),(0,s.jsx)("span",{className:(0,C.cn)("text-[10px] px-2 py-0.5 rounded-full font-medium","completed"===e.status?"bg-green-500/15 text-green-400":"running"===e.status?"bg-brand-500/15 text-brand-400":"error"===e.status?"bg-red-500/15 text-red-400":"bg-white/[0.06] text-gray-500"),children:"completed"===e.status?"Done":"running"===e.status?"Scanning":"error"===e.status?"Failed":"Queued"}),n&&(0,s.jsx)(g.Z,{className:"w-3 h-3 text-gray-500"})]})]},e.scanId)})}),!q&&E.some(e=>"completed"===e.status)&&(0,s.jsx)("div",{className:"px-5 py-2 border-t border-white/[0.06]",children:(0,s.jsx)("p",{className:"text-[10px] text-gray-500",children:"Click a completed scan to view its detailed report"})})]}),I.length>0&&(0,s.jsxs)("div",{className:"card",children:[(0,s.jsx)("div",{className:"px-5 py-4 border-b border-white/[0.06]",children:(0,s.jsx)("h3",{className:"text-sm font-semibold text-gray-200",children:"Recent Scans"})}),(0,s.jsx)("div",{className:"divide-y divide-white/[0.04]",children:I.slice(0,10).map(e=>(0,s.jsxs)("div",{className:"px-5 py-3 flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:["pass"===e.status?(0,s.jsx)(m.Z,{className:"w-4 h-4 text-green-400"}):(0,s.jsx)(f.Z,{className:"w-4 h-4 text-red-400"}),(0,s.jsx)("span",{className:"text-xs font-mono text-gray-400",children:e.scanId})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("span",{className:(0,C.cn)("text-sm font-bold",e.score>=95?"text-green-400":"text-amber-400"),children:e.score}),(0,s.jsx)("span",{className:"text-xs text-gray-500",children:(0,C.Sy)(e.timestamp)})]})]},e.scanId))})]})]}),"schedule"===X&&P&&(0,s.jsxs)("div",{className:"card p-5 space-y-4",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-gray-200",children:"Scan Schedule"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-gray-500 mb-1 block",children:"Cron Expression"}),(0,s.jsx)("input",{value:P.schedule.cron,onChange:e=>B({...P,schedule:{...P.schedule,cron:e.target.value}}),className:"input font-mono",placeholder:"0 2 * * *"}),(0,s.jsx)("p",{className:"text-[10px] text-gray-600 mt-1",children:"Default: 0 2 * * * (Daily at 2 AM)"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-gray-500 mb-1 block",children:"Timezone"}),(0,s.jsx)("input",{value:P.schedule.timezone,onChange:e=>B({...P,schedule:{...P.schedule,timezone:e.target.value}}),className:"input",placeholder:"Asia/Kolkata"})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("label",{className:"text-sm text-gray-300",children:"Scheduler Enabled"}),(0,s.jsx)("button",{onClick:()=>B({...P,schedule:{...P.schedule,enabled:!P.schedule.enabled}}),className:(0,C.cn)("w-10 h-6 rounded-full transition-colors relative",P.schedule.enabled?"bg-brand-600":"bg-surface-4"),children:(0,s.jsx)("span",{className:(0,C.cn)("absolute top-1 w-4 h-4 rounded-full bg-white transition-transform",P.schedule.enabled?"left-5":"left-1")})})]}),(0,s.jsxs)("button",{onClick:Y,disabled:J,className:"btn-primary",children:[J?(0,s.jsx)(u.Z,{className:"w-4 h-4 animate-spin"}):(0,s.jsx)(p,{className:"w-4 h-4"}),"Save Schedule"]})]}),"thresholds"===X&&P&&(0,s.jsxs)("div",{className:"card p-5 space-y-4",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-gray-200",children:"KPI Score Thresholds"}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Set minimum passing scores. Scans below these thresholds trigger alerts."}),(0,s.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:["overall","security","performance","codeQuality"].map(e=>(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-gray-500 capitalize mb-1 block",children:e.replace("codeQuality","Code Quality")}),(0,s.jsx)("input",{type:"number",min:0,max:100,value:P.thresholds[e],onChange:t=>B({...P,thresholds:{...P.thresholds,[e]:Number(t.target.value)}}),className:"input text-center font-mono"})]},e))}),(0,s.jsxs)("button",{onClick:Y,disabled:J,className:"btn-primary",children:[J?(0,s.jsx)(u.Z,{className:"w-4 h-4 animate-spin"}):(0,s.jsx)(p,{className:"w-4 h-4"}),"Save Thresholds"]})]}),"notifications"===X&&P&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"card p-5 space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(y,{className:"w-4 h-4 text-gray-400"}),(0,s.jsx)("span",{className:"text-sm font-semibold text-gray-200",children:"Slack"})]}),(0,s.jsx)("button",{onClick:()=>B({...P,notifications:{...P.notifications,slack:{...P.notifications.slack,enabled:!P.notifications.slack.enabled}}}),className:(0,C.cn)("w-10 h-6 rounded-full transition-colors relative",P.notifications.slack.enabled?"bg-brand-600":"bg-surface-4"),children:(0,s.jsx)("span",{className:(0,C.cn)("absolute top-1 w-4 h-4 rounded-full bg-white transition-transform",P.notifications.slack.enabled?"left-5":"left-1")})})]}),P.notifications.slack.enabled&&(0,s.jsx)("input",{value:P.notifications.slack.channel,onChange:e=>B({...P,notifications:{...P.notifications,slack:{...P.notifications.slack,channel:e.target.value}}}),className:"input",placeholder:"#ott-monitoring"})]}),(0,s.jsxs)("div",{className:"card p-5 space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(b,{className:"w-4 h-4 text-gray-400"}),(0,s.jsx)("span",{className:"text-sm font-semibold text-gray-200",children:"Email"})]}),(0,s.jsx)("button",{onClick:()=>B({...P,notifications:{...P.notifications,email:{...P.notifications.email,enabled:!P.notifications.email.enabled}}}),className:(0,C.cn)("w-10 h-6 rounded-full transition-colors relative",P.notifications.email.enabled?"bg-brand-600":"bg-surface-4"),children:(0,s.jsx)("span",{className:(0,C.cn)("absolute top-1 w-4 h-4 rounded-full bg-white transition-transform",P.notifications.email.enabled?"left-5":"left-1")})})]}),P.notifications.email.enabled&&(0,s.jsx)("input",{value:P.notifications.email.recipients.join(", "),onChange:e=>B({...P,notifications:{...P.notifications,email:{...P.notifications.email,recipients:e.target.value.split(",").map(e=>e.trim())}}}),className:"input",placeholder:"cto@dishtv.in, dev@dishtv.in"})]}),(0,s.jsxs)("div",{className:"card p-5 space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(j.Z,{className:"w-4 h-4 text-gray-400"}),(0,s.jsx)("span",{className:"text-sm font-semibold text-gray-200",children:"Jira Auto-Tickets"})]}),(0,s.jsx)("button",{onClick:()=>B({...P,notifications:{...P.notifications,jira:{...P.notifications.jira,enabled:!P.notifications.jira.enabled}}}),className:(0,C.cn)("w-10 h-6 rounded-full transition-colors relative",P.notifications.jira.enabled?"bg-brand-600":"bg-surface-4"),children:(0,s.jsx)("span",{className:(0,C.cn)("absolute top-1 w-4 h-4 rounded-full bg-white transition-transform",P.notifications.jira.enabled?"left-5":"left-1")})})]}),P.notifications.jira.enabled&&(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("label",{className:"text-xs text-gray-500",children:"Auto-create for:"}),(0,s.jsx)("span",{className:"badge bg-red-500/15 text-red-400 border-red-500/30 text-xs",children:"Critical & High"}),(0,s.jsxs)("span",{className:"text-xs text-gray-500",children:["Project: ",P.notifications.jira.projectKey]})]})]}),(0,s.jsxs)("button",{onClick:Y,disabled:J,className:"btn-primary",children:[J?(0,s.jsx)(u.Z,{className:"w-4 h-4 animate-spin"}):(0,s.jsx)(p,{className:"w-4 h-4"}),"Save Notification Settings"]})]}),"webhooks"===X&&(0,s.jsxs)("div",{className:"card",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between px-5 py-4 border-b border-white/[0.06]",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-gray-200",children:"Webhook Logs"}),(0,s.jsxs)("button",{onClick:()=>(0,S.hO)(20).then(F),className:"btn-ghost text-xs",children:[(0,s.jsx)(v.Z,{className:"w-3.5 h-3.5"})," Refresh"]})]}),(0,s.jsxs)("table",{className:"data-table",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Time"}),(0,s.jsx)("th",{children:"Event"}),(0,s.jsx)("th",{children:"Source"}),(0,s.jsx)("th",{children:"Status"})]})}),(0,s.jsx)("tbody",{children:0===D.length?(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:4,className:"text-center text-gray-500 py-8",children:"No webhook events"})}):D.map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"text-xs text-gray-400",children:(0,C.Sy)(e.timestamp)}),(0,s.jsx)("td",{className:"text-xs text-gray-200",children:e.event}),(0,s.jsx)("td",{className:"text-xs text-gray-400",children:e.source}),(0,s.jsx)("td",{children:"success"===e.status?(0,s.jsx)("span",{className:"badge bg-green-500/15 text-green-400 border-green-500/30 text-[10px]",children:"Success"}):(0,s.jsx)("span",{className:"badge bg-red-500/15 text-red-400 border-red-500/30 text-[10px]",children:"Failed"})})]},e.id))})]})]})]})]})]})}},44481:function(e,t,n){"use strict";n.d(t,{w:function(){return i}});var s=n(2265),a=n(92371),r=n(71837),c=n(79286);function i(){let{report:e,target:t,loading:n,error:i,setReport:l,setTarget:o,setLoading:d,setError:u}=(0,a.nq)(),{activeScan:h,setActiveScan:x,completeScan:m}=(0,a.rG)(),f=(0,s.useCallback)(async()=>{if(t){d(!0);try{let e=await (0,r.IK)(t);l(e)}catch(e){u(e.message)}}},[t,l,d,u]),g=(0,s.useCallback)(async e=>{d(!0);try{let t=await (0,r.lZ)(e);return x({scanId:t.scanId,status:"running",agents:{security:{progress:0,status:"queued"},performance:{progress:0,status:"queued"},"code-quality":{progress:0,status:"queued"},"report-generator":{progress:0,status:"queued"}},startedAt:new Date().toISOString()}),t}catch(e){throw u(e.message),e}},[x,d,u]);(0,s.useEffect)(()=>{let e=(0,c.gN)(e=>{m(e.scanId,e.score,e.status),f()}),t=(0,c.DF)(()=>{x(null),d(!1)});return()=>{e(),t()}},[m,x,f,d]);let p=(null==e?void 0:e.agentResults.find(e=>"security"===e.agentType))||null,y=(null==e?void 0:e.agentResults.find(e=>"performance"===e.agentType))||null,b=(null==e?void 0:e.agentResults.find(e=>"code-quality"===e.agentType))||null,j=((null==e?void 0:e.agentResults.flatMap(e=>e.findings))||[]).reduce((e,t)=>(e[t.severity]=(e[t.severity]||0)+1,e),{});return{report:e,target:t,loading:n,error:i,activeScan:h,securityResult:p,performanceResult:y,codeQualityResult:b,findingsBySeverity:j,setTarget:o,startScan:g,refresh:f}}},71837:function(e,t,n){"use strict";async function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=localStorage.getItem("vzy_token"),s=await fetch("".concat("https://vzy-api-gro1.onrender.com/api").concat(e),{...t,headers:{"Content-Type":"application/json",...n?{Authorization:"Bearer ".concat(n)}:{},...t.headers}});if(!s.ok){let e=await s.json().catch(()=>({error:s.statusText}));throw new a(s.status,e.error||s.statusText)}return s.json()}n.d(t,{Aj:function(){return c},FX:function(){return l},IK:function(){return r},Nq:function(){return g},Qx:function(){return y},Rf:function(){return m},bx:function(){return o},h8:function(){return p},hO:function(){return h},iE:function(){return d},lZ:function(){return i},r4:function(){return f},rF:function(){return u},te:function(){return b},x4:function(){return x}});class a extends Error{constructor(e,t){super(t),this.status=e,this.name="ApiError"}}async function r(e){return s("/reports/latest?target=".concat(encodeURIComponent(e)))}async function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;return s("/trends?target=".concat(encodeURIComponent(e),"&days=").concat(t))}async function i(e){return s("/scans",{method:"POST",body:JSON.stringify(e)})}async function l(e){return s("/scans/batch",{method:"POST",body:JSON.stringify(e)})}async function o(e){return s("/scans/".concat(e,"/abort"),{method:"POST"})}async function d(){return s("/config")}async function u(e){return s("/config",{method:"PATCH",body:JSON.stringify(e)})}async function h(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return s("/webhooks/logs?limit=".concat(e))}async function x(e,t){return s("/auth/login",{method:"POST",body:JSON.stringify({email:e,password:t})})}async function m(){return s("/auth/users")}async function f(e){return s("/auth/users",{method:"POST",body:JSON.stringify(e)})}async function g(e,t){return s("/auth/users/".concat(e),{method:"PUT",body:JSON.stringify(t)})}async function p(e){return s("/auth/users/".concat(e),{method:"DELETE"})}async function y(){return s("/health")}async function b(e){return s("/jira/create",{method:"POST",body:JSON.stringify({findingId:e})})}},92371:function(e,t,n){"use strict";n.d(t,{HB:function(){return o},eX:function(){return l},nq:function(){return c},rG:function(){return i},tN:function(){return r}});var s=n(59625),a=n(89134);let r=(0,s.Ue)()((0,a.tJ)((e,t)=>({user:null,token:null,setAuth:(t,n)=>{e({user:t,token:n}),localStorage.setItem("vzy_token",n),document.cookie="vzy_token=".concat(n,"; path=/; max-age=").concat(86400,"; SameSite=Lax")},logout:()=>{e({user:null,token:null}),localStorage.removeItem("vzy_token"),document.cookie="vzy_token=; path=/; max-age=0"},hasRole:e=>{let n=t().user;return!!n&&e.includes(n.role)}}),{name:"vzy-auth"})),c=(0,s.Ue)(e=>({report:null,target:"",loading:!1,error:null,setReport:t=>e({report:t,error:null}),setTarget:t=>e({target:t}),setLoading:t=>e({loading:t}),setError:t=>e({error:t,loading:!1})})),i=(0,s.Ue)((e,t)=>({activeScan:null,scanHistory:[],setActiveScan:t=>e({activeScan:t}),updateAgentProgress:(n,s,a,r)=>{let c=t().activeScan;c&&c.scanId===n&&e({activeScan:{...c,agents:{...c.agents,[s]:{progress:a,status:r}}}})},completeScan:(t,n,s)=>{e(e=>({activeScan:null,scanHistory:[{scanId:t,score:n,status:s,timestamp:new Date().toISOString()},...e.scanHistory.slice(0,49)]}))}})),l=(0,s.Ue)(e=>({batchId:null,batchScans:[],batchRunning:!1,startBatch:(t,n)=>e({batchId:t,batchScans:n.map(e=>({...e,status:"queued"})),batchRunning:!0}),updateBatchEntry:(t,n)=>e(e=>({batchScans:e.batchScans.map(e=>e.scanId===t?{...e,...n}:e)})),clearBatch:()=>e({batchId:null,batchScans:[],batchRunning:!1})})),o=(0,s.Ue)()((0,a.tJ)(e=>({sidebarCollapsed:!1,trendRange:30,toggleSidebar:()=>e(e=>({sidebarCollapsed:!e.sidebarCollapsed})),setTrendRange:t=>e({trendRange:t})}),{name:"vzy-ui"}))},93448:function(e,t,n){"use strict";n.d(t,{$G:function(){return h},Sy:function(){return u},Uc:function(){return c},Uz:function(){return i},cn:function(){return r},dH:function(){return d},pK:function(){return l},td:function(){return o}});var s=n(61994),a=n(53335);function r(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,a.m6)((0,s.W)(t))}function c(e){return e>=95?"healthy":e>=80?"warning":"critical"}function i(e){return e>=95?"text-kpi-pass":e>=80?"text-kpi-warn":"text-kpi-fail"}function l(e){return({critical:"bg-red-500/15 text-red-400 border-red-500/30",high:"bg-orange-500/15 text-orange-400 border-orange-500/30",medium:"bg-amber-500/15 text-amber-400 border-amber-500/30",low:"bg-blue-500/15 text-blue-400 border-blue-500/30",info:"bg-gray-500/15 text-gray-400 border-gray-500/30"})[e]}function o(e){if(0===e)return"0 B";let t=Math.floor(Math.log(e)/Math.log(1024));return"".concat(parseFloat((e/Math.pow(1024,t)).toFixed(1))," ").concat(["B","KB","MB","GB"][t])}function d(e){return e<1e3?"".concat(Math.round(e),"ms"):"".concat((e/1e3).toFixed(1),"s")}function u(e){let t="string"==typeof e?new Date(e):e,n=Math.floor((Date.now()-t.getTime())/6e4);if(n<1)return"just now";if(n<60)return"".concat(n,"m ago");let s=Math.floor(n/60);return s<24?"".concat(s,"h ago"):"".concat(Math.floor(s/24),"d ago")}function h(e,t){return e.length<=t?e:e.slice(0,t)+"..."}},79286:function(e,t,n){"use strict";n.d(t,{$j:function(){return i},DF:function(){return d},H0:function(){return u},WH:function(){return h},gN:function(){return o},zP:function(){return l}});var s=n(68680);let a=n(40257).env.WS_URL||"https://vzy-api-gro1.onrender.com",r=null,c={"scan:progress":new Set,"scan:complete":new Set,"scan:error":new Set,"batch:progress":new Set,"batch:complete":new Set};function i(){return(null==r?void 0:r.connected)||((r=(0,s.io)(a,{transports:["websocket","polling"],reconnection:!0,reconnectionDelay:2e3,reconnectionAttempts:10,auth:{token:localStorage.getItem("vzy_token")}})).on("connect",()=>{console.info("[WS] Connected:",null==r?void 0:r.id)}),r.on("disconnect",e=>{console.warn("[WS] Disconnected:",e)}),r.on("scan:progress",e=>{c["scan:progress"].forEach(t=>t(e))}),r.on("scan:complete",e=>{c["scan:complete"].forEach(t=>t(e))}),r.on("scan:error",e=>{c["scan:error"].forEach(t=>t(e))}),r.on("batch:progress",e=>{c["batch:progress"].forEach(t=>t(e))}),r.on("batch:complete",e=>{c["batch:complete"].forEach(t=>t(e))})),r}function l(){null==r||r.disconnect(),r=null}function o(e){return c["scan:complete"].add(e),()=>{c["scan:complete"].delete(e)}}function d(e){return c["scan:error"].add(e),()=>{c["scan:error"].delete(e)}}function u(e){return c["batch:progress"].add(e),()=>{c["batch:progress"].delete(e)}}function h(e){return c["batch:complete"].add(e),()=>{c["batch:complete"].delete(e)}}}},function(e){e.O(0,[809,137,324,458,971,117,744],function(){return e(e.s=72894)}),_N_E=e.O()}]);