(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[127],{91951:function(e,s,t){Promise.resolve().then(t.bind(t,93020))},30401:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(79205).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},10407:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(79205).Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},88906:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(79205).Z)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},93020:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return Z}});var a=t(57437),i=t(2265),r=t(79205);let n=(0,r.Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),l=(0,r.Z)("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);var d=t(76865);let c=(0,r.Z)("FileWarning",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var o=t(88906);let x=(0,r.Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),h=(0,r.Z)("Fingerprint",[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]]);var m=t(92934),g=t(29202),p=t(10407),u=t(99388),j=t(32489);let v=(0,r.Z)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);var b=t(29761),y=t(85675),f=t(67437),N=t(94022),w=t(64742),k=t(44481),S=t(71837),C=t(93448);let A=[{id:"A01",name:"Broken Access Control",icon:n,description:"Failures in access control enforcement that allow users to act outside their intended permissions."},{id:"A02",name:"Cryptographic Failures",icon:l,description:"Failures related to cryptography that often lead to sensitive data exposure."},{id:"A03",name:"Injection",icon:d.Z,description:"User-supplied data sent to an interpreter as part of a command or query (SQL, NoSQL, OS, LDAP)."},{id:"A04",name:"Insecure Design",icon:c,description:"Risks related to design and architectural flaws, calling for more use of threat modeling and secure design patterns."},{id:"A05",name:"Security Misconfiguration",icon:o.Z,description:"Missing or incorrect security hardening across any part of the application stack."},{id:"A06",name:"Vulnerable Components",icon:x,description:"Using components with known vulnerabilities that may undermine application defenses."},{id:"A07",name:"Auth Failures",icon:h,description:"Confirmation of user identity, authentication, and session management weaknesses."},{id:"A08",name:"Data Integrity",icon:m.Z,description:"Software and data integrity failures related to code and infrastructure that does not protect against integrity violations."},{id:"A09",name:"Logging Failures",icon:c,description:"Insufficient logging, detection, monitoring, and active response."},{id:"A10",name:"SSRF",icon:g.Z,description:"Server-Side Request Forgery flaws occur when a web application fetches a remote resource without validating the user-supplied URL."}];function Z(){var e,s,t,r,c,h,j,v,Z,M,R,P,O,L,F,E,U;let{report:T,securityResult:H}=(0,k.w)(),[q,z]=(0,i.useState)("overview"),[X,J]=(0,i.useState)("all"),[W,_]=(0,i.useState)(null),[G,Q]=(0,i.useState)(null);if(!T||!H)return(0,a.jsx)("div",{className:"flex items-center justify-center h-[60vh]",children:(0,a.jsxs)("div",{className:"text-center text-gray-500 space-y-2",children:[(0,a.jsx)(o.Z,{className:"w-12 h-12 mx-auto opacity-30"}),(0,a.jsx)("p",{className:"text-sm",children:"No security scan data available. Run a scan from the Overview page."})]})});let Y=H.metadata,B=H.findings,$=B.reduce((e,s)=>(e[s.severity]=(e[s.severity]||0)+1,e),{}),ee="all"===X?B:B.filter(e=>e.severity===X),es=async e=>{try{let s=await (0,S.te)(e);alert("Jira ticket created: ".concat(s.ticketId))}catch(e){alert("Failed to create Jira ticket")}};return(0,a.jsxs)("div",{className:"space-y-6 max-w-[1440px] mx-auto relative",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl font-bold text-gray-100",children:"Security Analysis"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"OWASP Top 10, API exposure, DRM, tokens, dependencies"})]}),(0,a.jsx)(b.O,{score:H.score.rawScore,label:"Security",size:"sm",showStatus:!1})]}),(0,a.jsx)("div",{className:"flex gap-1 border-b border-white/[0.06] pb-px",children:[{id:"overview",label:"Overview"},{id:"owasp",label:"OWASP Grid"},{id:"cve",label:"CVE / Dependencies"},{id:"api",label:"API Exposure"},{id:"raw",label:"Raw JSON"}].map(e=>(0,a.jsx)("button",{onClick:()=>z(e.id),className:(0,C.cn)("px-4 py-2.5 text-sm font-medium border-b-2 transition-colors",q===e.id?"text-brand-400 border-brand-500":"text-gray-400 border-transparent hover:text-gray-200"),children:e.label},e.id))}),"overview"===q&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[(0,a.jsx)(f.i,{label:"SSL Grade",value:(null==Y?void 0:null===(e=Y.sslAnalysis)||void 0===e?void 0:e.grade)||"N/A",icon:n,status:(null==Y?void 0:null===(s=Y.sslAnalysis)||void 0===s?void 0:s.grade)==="A+"?"good":"warn",onClick:()=>_("ssl")}),(0,a.jsx)(f.i,{label:"Headers Score",value:"".concat((null==Y?void 0:null===(t=Y.headerAnalysis)||void 0===t?void 0:t.score)||0,"%"),icon:o.Z,status:((null==Y?void 0:null===(r=Y.headerAnalysis)||void 0===r?void 0:r.score)||0)>=80?"good":"warn",onClick:()=>_("headers")}),(0,a.jsx)(f.i,{label:"Missing Headers",value:(null==Y?void 0:null===(h=Y.headerAnalysis)||void 0===h?void 0:null===(c=h.missing)||void 0===c?void 0:c.length)||0,icon:d.Z,status:0===((null==Y?void 0:null===(v=Y.headerAnalysis)||void 0===v?void 0:null===(j=v.missing)||void 0===j?void 0:j.length)||0)?"good":"bad",onClick:()=>_("missing-headers")}),(0,a.jsx)(f.i,{label:"CORS Issues",value:(null==Y?void 0:null===(M=Y.corsAnalysis)||void 0===M?void 0:null===(Z=M.issues)||void 0===Z?void 0:Z.length)||0,icon:g.Z,status:0===((null==Y?void 0:null===(P=Y.corsAnalysis)||void 0===P?void 0:null===(R=P.issues)||void 0===R?void 0:R.length)||0)?"good":"warn",onClick:()=>_("cors")}),(0,a.jsx)(f.i,{label:"Token Leaks",value:(null==Y?void 0:null===(O=Y.tokenLeaks)||void 0===O?void 0:O.length)||0,icon:l,status:0===((null==Y?void 0:null===(L=Y.tokenLeaks)||void 0===L?void 0:L.length)||0)?"good":"bad",onClick:()=>_("tokens")}),(0,a.jsx)(f.i,{label:"Dep. Vulns",value:(null==Y?void 0:null===(F=Y.dependencyVulns)||void 0===F?void 0:F.length)||0,icon:x,status:0===((null==Y?void 0:null===(E=Y.dependencyVulns)||void 0===E?void 0:E.length)||0)?"good":"bad",onClick:()=>_("deps")})]}),(null==Y?void 0:Y.drmAnalysis)&&(0,a.jsxs)("button",{onClick:()=>_("drm"),className:"card p-5 w-full text-left cursor-pointer hover:bg-white/[0.04] hover:border-brand-500/30 transition-all group",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-gray-200",children:"DRM Protection Status"}),(0,a.jsxs)("div",{className:"flex items-center gap-1 text-[10px] text-gray-600 group-hover:text-brand-400 transition-colors",children:["View details ",(0,a.jsx)(p.Z,{className:"w-3 h-3"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,a.jsx)(I,{label:"Widevine",active:Y.drmAnalysis.widevineDetected}),(0,a.jsx)(I,{label:"FairPlay",active:Y.drmAnalysis.fairplayDetected}),(0,a.jsx)(I,{label:"Key Rotation",active:Y.drmAnalysis.keyRotation}),(0,a.jsx)(I,{label:"License URL Safe",active:!Y.drmAnalysis.licenseUrlExposed,isInverse:!0})]}),Y.drmAnalysis.issues.length>0&&(0,a.jsxs)("div",{className:"mt-3 space-y-1",children:[Y.drmAnalysis.issues.slice(0,2).map((e,s)=>(0,a.jsxs)("div",{className:"text-xs text-red-400 flex items-center gap-2",children:[(0,a.jsx)(u.Z,{className:"w-3 h-3"})," ",e]},s)),Y.drmAnalysis.issues.length>2&&(0,a.jsxs)("div",{className:"text-[10px] text-gray-500",children:["+",Y.drmAnalysis.issues.length-2," more issues"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-12 gap-6",children:[(0,a.jsx)("div",{className:"col-span-12 lg:col-span-8",children:(0,a.jsxs)("div",{className:"card",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-5 py-4 border-b border-white/[0.06]",children:[(0,a.jsxs)("h3",{className:"text-sm font-semibold text-gray-200",children:["Findings (",ee.length,")"]}),(0,a.jsxs)("select",{value:X,onChange:e=>J(e.target.value),className:"input w-32 text-xs py-1.5",children:[(0,a.jsx)("option",{value:"all",children:"All Severities"}),(0,a.jsx)("option",{value:"critical",children:"Critical"}),(0,a.jsx)("option",{value:"high",children:"High"}),(0,a.jsx)("option",{value:"medium",children:"Medium"}),(0,a.jsx)("option",{value:"low",children:"Low"})]})]}),(0,a.jsx)("div",{className:"max-h-[500px] overflow-y-auto",children:ee.map(e=>(0,a.jsx)(N.R,{finding:e,onCreateJira:es},e.id))})]})}),(0,a.jsx)("div",{className:"col-span-12 lg:col-span-4",children:(0,a.jsxs)("div",{className:"card p-5",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-gray-200 mb-2",children:"Severity Distribution"}),(0,a.jsx)(y.O,{data:$})]})})]})]}),"owasp"===q&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4",children:A.map(e=>{let s=B.filter(s=>s.category.includes(e.id)),t=s.length>0,i=s.length>0?s.sort((e,s)=>K(e.severity)-K(s.severity))[0].severity:null,r=e.icon,n=G===e.id;return(0,a.jsxs)("button",{onClick:()=>Q(n?null:e.id),className:(0,C.cn)("card p-4 space-y-2 text-left w-full cursor-pointer transition-all group",t?"border-red-500/20 hover:border-red-500/40":"border-green-500/10 hover:border-green-500/30",n&&"ring-2 ring-brand-500/50 border-brand-500/30"),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-xs font-bold text-gray-400",children:e.id}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[t?(0,a.jsx)("span",{className:(0,C.cn)("badge text-[10px]",(0,C.pK)(i)),children:s.length}):(0,a.jsx)(m.Z,{className:"w-4 h-4 text-green-500/60"}),(0,a.jsx)(p.Z,{className:(0,C.cn)("w-3 h-3 text-gray-600 group-hover:text-brand-400 transition-all",n&&"rotate-90 text-brand-400")})]})]}),(0,a.jsx)(r,{className:(0,C.cn)("w-6 h-6",t?"text-red-400/60":"text-green-400/40")}),(0,a.jsx)("div",{className:"text-xs font-medium text-gray-300",children:e.name}),(0,a.jsx)("div",{className:"text-[10px] text-gray-600 group-hover:text-gray-400 transition-colors",children:"Click for details"})]},e.id)})}),G&&(0,a.jsx)(V,{category:A.find(e=>e.id===G),findings:B.filter(e=>e.category.includes(G)),owaspMeta:(null==Y?void 0:null===(U=Y.owaspFindings)||void 0===U?void 0:U.filter(e=>e.category.includes(G)))||[],onClose:()=>Q(null),onCreateJira:es})]}),"cve"===q&&(0,a.jsx)("div",{className:"card",children:(0,a.jsxs)("table",{className:"data-table",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Package"}),(0,a.jsx)("th",{children:"Version"}),(0,a.jsx)("th",{children:"Severity"}),(0,a.jsx)("th",{children:"CVE"}),(0,a.jsx)("th",{children:"Vulnerability"}),(0,a.jsx)("th",{children:"Fix Version"})]})}),(0,a.jsx)("tbody",{children:0===((null==Y?void 0:Y.dependencyVulns)||[]).length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:6,className:"text-center text-gray-500 py-8",children:"No dependency vulnerabilities found"})}):Y.dependencyVulns.map((e,s)=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"font-mono text-xs text-gray-200",children:e.package}),(0,a.jsx)("td",{className:"font-mono text-xs text-gray-400",children:e.version}),(0,a.jsx)("td",{children:(0,a.jsx)("span",{className:(0,C.cn)("badge text-[10px]",(0,C.pK)(e.severity)),children:e.severity.toUpperCase()})}),(0,a.jsx)("td",{className:"text-xs text-brand-400",children:e.cveId}),(0,a.jsx)("td",{className:"text-xs text-gray-300 max-w-[200px] truncate",children:e.vulnerability}),(0,a.jsx)("td",{className:"text-xs text-green-400",children:e.fixVersion||"—"})]},s))})]})}),"api"===q&&(0,a.jsx)("div",{className:"card",children:(0,a.jsxs)("table",{className:"data-table",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Method"}),(0,a.jsx)("th",{children:"Endpoint"}),(0,a.jsx)("th",{children:"Auth"}),(0,a.jsx)("th",{children:"Sensitive Data"}),(0,a.jsx)("th",{children:"Rate Limit"}),(0,a.jsx)("th",{children:"Issues"})]})}),(0,a.jsx)("tbody",{children:0===((null==Y?void 0:Y.apiExposure)||[]).length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:6,className:"text-center text-gray-500 py-8",children:"No API exposures detected"})}):Y.apiExposure.map((e,s)=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:(0,a.jsx)("span",{className:"badge bg-blue-500/15 text-blue-400 border-blue-500/30 text-[10px]",children:e.method})}),(0,a.jsx)("td",{className:"font-mono text-xs text-gray-200 max-w-[250px] truncate",children:e.endpoint}),(0,a.jsx)("td",{children:e.authenticated?(0,a.jsx)(m.Z,{className:"w-4 h-4 text-green-400"}):(0,a.jsx)(u.Z,{className:"w-4 h-4 text-red-400"})}),(0,a.jsx)("td",{children:e.sensitiveData?(0,a.jsx)(d.Z,{className:"w-4 h-4 text-amber-400"}):(0,a.jsx)("span",{className:"text-gray-500 text-xs",children:"No"})}),(0,a.jsx)("td",{children:e.rateLimit?(0,a.jsx)(m.Z,{className:"w-4 h-4 text-green-400"}):(0,a.jsx)(u.Z,{className:"w-4 h-4 text-red-400"})}),(0,a.jsx)("td",{className:"text-xs text-gray-400",children:e.issues.length>0?e.issues.join(", "):"—"})]},s))})]})}),"raw"===q&&(0,a.jsx)(w.h,{data:H,defaultExpanded:!0,maxHeight:600}),W&&(0,a.jsx)(D,{meta:Y,detailType:W,onClose:()=>{_(null),Q(null)},findings:B})]})}function D(e){let{meta:s,detailType:t,onClose:i,findings:r}=e;return t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-black/60 z-40",onClick:i}),(0,a.jsxs)("div",{className:"fixed right-0 top-0 h-full w-full max-w-lg bg-surface-0 border-l border-white/[0.06] z-50 flex flex-col animate-slide-in-right overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-white/[0.06] shrink-0",children:[(0,a.jsx)("h2",{className:"text-sm font-bold text-gray-100",children:{ssl:"SSL / TLS Analysis",headers:"Security Headers Analysis","missing-headers":"Missing Security Headers",cors:"CORS Configuration",tokens:"Token Leak Detection",deps:"Dependency Vulnerabilities",drm:"DRM Protection Details"}[t]}),(0,a.jsx)("button",{onClick:i,className:"p-1.5 rounded-lg hover:bg-white/[0.06] text-gray-400 hover:text-gray-200 transition-colors",children:(0,a.jsx)(j.Z,{className:"w-4 h-4"})})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto px-6 py-5 space-y-5",children:["ssl"===t&&(0,a.jsx)(M,{data:null==s?void 0:s.sslAnalysis}),"headers"===t&&(0,a.jsx)(R,{data:null==s?void 0:s.headerAnalysis}),"missing-headers"===t&&(0,a.jsx)(P,{data:null==s?void 0:s.headerAnalysis}),"cors"===t&&(0,a.jsx)(O,{data:null==s?void 0:s.corsAnalysis}),"tokens"===t&&(0,a.jsx)(L,{data:null==s?void 0:s.tokenLeaks}),"deps"===t&&(0,a.jsx)(F,{data:null==s?void 0:s.dependencyVulns}),"drm"===t&&(0,a.jsx)(E,{data:null==s?void 0:s.drmAnalysis,findings:r})]})]})]}):null}function M(e){let{data:s}=e;return s?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsx)(U,{label:"SSL Grade",value:s.grade,highlight:"A+"===s.grade||"A"===s.grade}),(0,a.jsx)(U,{label:"Protocol",value:s.protocol}),(0,a.jsx)(U,{label:"Certificate Expiry",value:s.certExpiry||"Unknown"}),(0,a.jsx)(U,{label:"HSTS Enabled",value:s.hsts?"Yes":"No",highlight:s.hsts,bad:!s.hsts})]}),s.issues.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)(T,{label:"Issues Found",count:s.issues.length}),(0,a.jsx)("div",{className:"space-y-2 mt-2",children:s.issues.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-start gap-2 p-3 rounded-lg bg-red-500/[0.06] border border-red-500/10",children:[(0,a.jsx)(d.Z,{className:"w-3.5 h-3.5 text-red-400 mt-0.5 shrink-0"}),(0,a.jsx)("span",{className:"text-xs text-red-300",children:e})]},s))})]}),0===s.issues.length&&(0,a.jsxs)("div",{className:"flex items-center gap-2 p-3 rounded-lg bg-green-500/[0.06] border border-green-500/10",children:[(0,a.jsx)(m.Z,{className:"w-4 h-4 text-green-400"}),(0,a.jsx)("span",{className:"text-xs text-green-300",children:"No SSL issues detected"})]})]}):(0,a.jsx)(H,{label:"No SSL analysis data"})}function R(e){let{data:s}=e;return s?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(U,{label:"Overall Headers Score",value:"".concat(s.score,"%"),highlight:s.score>=80,bad:s.score<50}),s.present.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)(T,{label:"Present Headers",count:s.present.length}),(0,a.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:s.present.map((e,s)=>(0,a.jsx)("span",{className:"px-2.5 py-1 rounded-md bg-green-500/[0.08] border border-green-500/15 text-[11px] text-green-400 font-mono",children:e},s))})]}),s.missing.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)(T,{label:"Missing Headers",count:s.missing.length}),(0,a.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:s.missing.map((e,s)=>(0,a.jsx)("span",{className:"px-2.5 py-1 rounded-md bg-red-500/[0.08] border border-red-500/15 text-[11px] text-red-400 font-mono",children:e},s))})]}),s.misconfigured.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)(T,{label:"Misconfigured Headers",count:s.misconfigured.length}),(0,a.jsx)("div",{className:"space-y-2 mt-2",children:s.misconfigured.map((e,s)=>(0,a.jsxs)("div",{className:"p-3 rounded-lg bg-amber-500/[0.06] border border-amber-500/10",children:[(0,a.jsx)("div",{className:"text-xs font-mono text-amber-300 font-semibold",children:e.header}),(0,a.jsx)("div",{className:"text-[11px] text-amber-200/70 mt-1",children:e.issue})]},s))})]})]}):(0,a.jsx)(H,{label:"No headers analysis data"})}function P(e){let{data:s}=e;if(!s)return(0,a.jsx)(H,{label:"No headers analysis data"});let t=s.missing||[],i={"Strict-Transport-Security":"Enforces HTTPS connections, prevents protocol downgrade attacks and cookie hijacking.","Content-Security-Policy":"Prevents XSS, clickjacking, and other code injection attacks by specifying allowed content sources.","X-Content-Type-Options":"Prevents browsers from MIME-sniffing a response away from the declared content-type.","X-Frame-Options":"Prevents clickjacking by controlling whether the page can be embedded in iframes.","X-XSS-Protection":"Enables browser's built-in XSS filter to stop reflected XSS attacks.","Referrer-Policy":"Controls how much referrer information is included with requests.","Permissions-Policy":"Controls which browser features and APIs can be used in the page.","X-Download-Options":"Prevents IE from executing downloads in the site's context.","X-Permitted-Cross-Domain-Policies":"Controls Adobe Flash and PDF cross-domain data loading.","Cross-Origin-Opener-Policy":"Isolates the browsing context to prevent cross-origin attacks.","Cross-Origin-Resource-Policy":"Prevents other origins from reading the response.","Cross-Origin-Embedder-Policy":"Controls embedding of cross-origin resources."};return 0===t.length?(0,a.jsxs)("div",{className:"flex items-center gap-2 p-4 rounded-lg bg-green-500/[0.06] border border-green-500/10",children:[(0,a.jsx)(m.Z,{className:"w-5 h-5 text-green-400"}),(0,a.jsx)("span",{className:"text-sm text-green-300",children:"All critical security headers are present"})]}):(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("p",{className:"text-xs text-gray-400",children:"The following security headers are missing and should be configured to improve your security posture."}),t.map((e,s)=>(0,a.jsxs)("div",{className:"p-4 rounded-lg bg-red-500/[0.04] border border-red-500/10",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(u.Z,{className:"w-4 h-4 text-red-400 shrink-0"}),(0,a.jsx)("span",{className:"text-sm font-mono text-red-300 font-semibold",children:e})]}),i[e]&&(0,a.jsx)("p",{className:"text-[11px] text-gray-400 mt-2 ml-6",children:i[e]})]},s))]})}function O(e){let{data:s}=e;return s?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsx)(U,{label:"Allow-Origin",value:s.allowOrigin||"Not Set",bad:s.wildcardDetected}),(0,a.jsx)(U,{label:"Allow-Credentials",value:s.allowCredentials?"Yes":"No",bad:s.allowCredentials&&s.wildcardDetected}),(0,a.jsx)(U,{label:"Wildcard (*)",value:s.wildcardDetected?"Detected":"No",highlight:!s.wildcardDetected,bad:s.wildcardDetected})]}),s.wildcardDetected&&(0,a.jsxs)("div",{className:"p-3 rounded-lg bg-red-500/[0.06] border border-red-500/10 flex items-start gap-2",children:[(0,a.jsx)(d.Z,{className:"w-4 h-4 text-red-400 mt-0.5 shrink-0"}),(0,a.jsxs)("div",{className:"text-xs text-red-300",children:["Wildcard CORS origin (*) allows any website to make cross-origin requests to this domain.",s.allowCredentials&&" Combined with Allow-Credentials, this is a critical security risk."]})]}),s.issues.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)(T,{label:"CORS Issues",count:s.issues.length}),(0,a.jsx)("div",{className:"space-y-2 mt-2",children:s.issues.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-start gap-2 p-3 rounded-lg bg-amber-500/[0.06] border border-amber-500/10",children:[(0,a.jsx)(d.Z,{className:"w-3.5 h-3.5 text-amber-400 mt-0.5 shrink-0"}),(0,a.jsx)("span",{className:"text-xs text-amber-300",children:e})]},s))})]}),0===s.issues.length&&!s.wildcardDetected&&(0,a.jsxs)("div",{className:"flex items-center gap-2 p-3 rounded-lg bg-green-500/[0.06] border border-green-500/10",children:[(0,a.jsx)(m.Z,{className:"w-4 h-4 text-green-400"}),(0,a.jsx)("span",{className:"text-xs text-green-300",children:"CORS configuration looks secure"})]})]}):(0,a.jsx)(H,{label:"No CORS analysis data"})}function L(e){let{data:s}=e;return s&&0!==s.length?(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("p",{className:"text-xs text-gray-400",children:"Exposed tokens or secrets found in the application. These should be rotated immediately."}),s.map((e,s)=>(0,a.jsxs)("div",{className:"p-4 rounded-lg bg-red-500/[0.04] border border-red-500/10 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(l,{className:"w-4 h-4 text-red-400"}),(0,a.jsx)("span",{className:"text-xs font-semibold text-gray-200 uppercase",children:e.type.replace(/_/g," ")})]}),(0,a.jsx)("span",{className:(0,C.cn)("badge text-[10px]",(0,C.pK)(e.severity)),children:e.severity.toUpperCase()})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-[11px]",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Location:"})," ",(0,a.jsx)("span",{className:"text-gray-300 font-mono",children:e.location})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Partial:"})," ",(0,a.jsx)("span",{className:"text-red-300 font-mono",children:e.partial})]})]})]},s))]}):(0,a.jsxs)("div",{className:"flex items-center gap-2 p-4 rounded-lg bg-green-500/[0.06] border border-green-500/10",children:[(0,a.jsx)(m.Z,{className:"w-5 h-5 text-green-400"}),(0,a.jsx)("span",{className:"text-sm text-green-300",children:"No token leaks detected"})]})}function F(e){let{data:s}=e;if(!s||0===s.length)return(0,a.jsxs)("div",{className:"flex items-center gap-2 p-4 rounded-lg bg-green-500/[0.06] border border-green-500/10",children:[(0,a.jsx)(m.Z,{className:"w-5 h-5 text-green-400"}),(0,a.jsx)("span",{className:"text-sm text-green-300",children:"No dependency vulnerabilities found"})]});let t=s.reduce((e,s)=>(e[s.severity]=(e[s.severity]||0)+1,e),{});return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries(t).sort((e,s)=>K(e[0])-K(s[0])).map(e=>{let[s,t]=e;return(0,a.jsxs)("span",{className:(0,C.cn)("badge text-[10px] px-3 py-1",(0,C.pK)(s)),children:[t," ",s]},s)})}),s.map((e,s)=>(0,a.jsxs)("div",{className:"p-4 rounded-lg bg-surface-1 border border-white/[0.04] space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(x,{className:"w-4 h-4 text-gray-400"}),(0,a.jsxs)("span",{className:"text-xs font-mono text-gray-200 font-semibold",children:[e.package,"@",e.version]})]}),(0,a.jsx)("span",{className:(0,C.cn)("badge text-[10px]",(0,C.pK)(e.severity)),children:e.severity.toUpperCase()})]}),(0,a.jsx)("div",{className:"text-[11px] text-gray-300",children:e.vulnerability}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-[11px]",children:[(0,a.jsx)("span",{className:"text-brand-400 font-mono",children:e.cveId}),e.fixVersion&&(0,a.jsxs)("span",{className:"text-green-400",children:["Fix: ",(0,a.jsx)("span",{className:"font-mono",children:e.fixVersion})]})]})]},s))]})}function E(e){let{data:s,findings:t}=e;if(!s)return(0,a.jsx)(H,{label:"No DRM analysis data"});let i=t.filter(e=>e.title.toLowerCase().includes("drm")||e.category.toLowerCase().includes("drm")||e.description.toLowerCase().includes("drm")||e.description.toLowerCase().includes("widevine")||e.description.toLowerCase().includes("fairplay"));return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsx)(U,{label:"Widevine",value:s.widevineDetected?"Detected":"Not Found",highlight:s.widevineDetected,bad:!s.widevineDetected}),(0,a.jsx)(U,{label:"FairPlay",value:s.fairplayDetected?"Detected":"Not Found",highlight:s.fairplayDetected}),(0,a.jsx)(U,{label:"Key Rotation",value:s.keyRotation?"Enabled":"Disabled",highlight:s.keyRotation,bad:!s.keyRotation}),(0,a.jsx)(U,{label:"License URL",value:s.licenseUrlExposed?"Exposed":"Protected",highlight:!s.licenseUrlExposed,bad:s.licenseUrlExposed})]}),s.issues.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)(T,{label:"DRM Issues",count:s.issues.length}),(0,a.jsx)("div",{className:"space-y-2 mt-2",children:s.issues.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-start gap-2 p-3 rounded-lg bg-red-500/[0.06] border border-red-500/10",children:[(0,a.jsx)(d.Z,{className:"w-3.5 h-3.5 text-red-400 mt-0.5 shrink-0"}),(0,a.jsx)("span",{className:"text-xs text-red-300",children:e})]},s))})]}),i.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)(T,{label:"Related Findings",count:i.length}),(0,a.jsx)("div",{className:"space-y-2 mt-2",children:i.map(e=>(0,a.jsxs)("div",{className:"p-3 rounded-lg bg-surface-1 border border-white/[0.04]",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)("span",{className:(0,C.cn)("badge text-[10px]",(0,C.pK)(e.severity)),children:e.severity.toUpperCase()}),(0,a.jsx)("span",{className:"text-xs text-gray-200 font-medium",children:e.title})]}),(0,a.jsx)("div",{className:"text-[11px] text-gray-400",children:e.description}),e.remediation&&(0,a.jsxs)("div",{className:"text-[11px] text-green-400/70 mt-2",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Fix: "}),e.remediation]})]},e.id))})]}),0===s.issues.length&&(0,a.jsxs)("div",{className:"flex items-center gap-2 p-3 rounded-lg bg-green-500/[0.06] border border-green-500/10",children:[(0,a.jsx)(m.Z,{className:"w-4 h-4 text-green-400"}),(0,a.jsx)("span",{className:"text-xs text-green-300",children:"DRM configuration looks secure"})]})]})}function V(e){let{category:s,findings:t,owaspMeta:i,onClose:r,onCreateJira:n}=e,l=s.icon,d=t.length>0;return(0,a.jsxs)("div",{className:(0,C.cn)("card overflow-hidden animate-fade-up",d?"border-red-500/20":"border-green-500/15"),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-white/[0.06] bg-surface-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:(0,C.cn)("p-2 rounded-lg",d?"bg-red-500/10":"bg-green-500/10"),children:(0,a.jsx)(l,{className:(0,C.cn)("w-5 h-5",d?"text-red-400":"text-green-400")})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-sm font-bold text-gray-100",children:[s.id,": ",s.name]}),(0,a.jsx)("p",{className:"text-[11px] text-gray-500 mt-0.5 max-w-lg",children:s.description})]})]}),(0,a.jsx)("button",{onClick:r,className:"p-1.5 rounded-lg hover:bg-white/[0.06] text-gray-400 hover:text-gray-200 transition-colors",children:(0,a.jsx)(j.Z,{className:"w-4 h-4"})})]}),(0,a.jsx)("div",{className:"px-6 py-5",children:d||0!==i.length?(0,a.jsxs)("div",{className:"space-y-4",children:[i.length>0&&(0,a.jsx)("div",{className:"space-y-2",children:i.map((e,s)=>(0,a.jsxs)("div",{className:"p-4 rounded-lg bg-surface-1 border border-white/[0.04]",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-xs font-semibold text-gray-200",children:e.name}),(0,a.jsx)("span",{className:(0,C.cn)("badge text-[10px]",(0,C.pK)(e.risk)),children:e.risk.toUpperCase()})]}),(0,a.jsx)("p",{className:"text-[11px] text-gray-400",children:e.details}),e.affected.length>0&&(0,a.jsx)("div",{className:"mt-2 flex flex-wrap gap-1",children:e.affected.map((e,s)=>(0,a.jsx)("span",{className:"px-2 py-0.5 rounded bg-white/[0.04] text-[10px] text-gray-500 font-mono",children:e},s))})]},s))}),t.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)(T,{label:"Scan Findings",count:t.length}),(0,a.jsx)("div",{className:"mt-2 max-h-[400px] overflow-y-auto rounded-lg border border-white/[0.04]",children:t.map(e=>(0,a.jsx)(N.R,{finding:e,onCreateJira:n},e.id))})]})]}):(0,a.jsxs)("div",{className:"flex items-center gap-3 p-4 rounded-lg bg-green-500/[0.06] border border-green-500/10",children:[(0,a.jsx)(m.Z,{className:"w-5 h-5 text-green-400 shrink-0"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-green-300 font-medium",children:"No issues found"}),(0,a.jsx)("div",{className:"text-[11px] text-green-400/60 mt-0.5",children:"This OWASP category passed all checks"})]})]})})]})}function I(e){let{label:s,active:t,isInverse:i}=e;return(0,a.jsxs)("div",{className:(0,C.cn)("flex items-center gap-2 p-3 rounded-lg",t?"bg-green-500/[0.06]":"bg-red-500/[0.06]"),children:[t?(0,a.jsx)(m.Z,{className:"w-4 h-4 text-green-400"}):(0,a.jsx)(u.Z,{className:"w-4 h-4 text-red-400"}),(0,a.jsx)("span",{className:(0,C.cn)("text-sm",t?"text-green-400":"text-red-400"),children:s})]})}function U(e){let{label:s,value:t,highlight:i,bad:r}=e;return(0,a.jsxs)("div",{className:"p-3 rounded-lg bg-surface-1 border border-white/[0.04]",children:[(0,a.jsx)("div",{className:"text-[10px] text-gray-500 uppercase tracking-wider",children:s}),(0,a.jsx)("div",{className:(0,C.cn)("text-sm font-bold mt-1",r?"text-red-400":i?"text-green-400":"text-gray-200"),children:t})]})}function T(e){let{label:s,count:t}=e;return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-xs font-semibold text-gray-300",children:s}),(0,a.jsx)("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-white/[0.06] text-gray-500",children:t})]})}function H(e){let{label:s}=e;return(0,a.jsxs)("div",{className:"flex items-center gap-2 p-4 rounded-lg bg-white/[0.02] border border-white/[0.04]",children:[(0,a.jsx)(v,{className:"w-4 h-4 text-gray-500"}),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:s})]})}function K(e){return({critical:1,high:2,medium:3,low:4,info:5})[e]||5}},85675:function(e,s,t){"use strict";t.d(s,{O:function(){return x}});var a=t(57437),i=t(47625),r=t(75169),n=t(3574),l=t(20407),d=t(8147),c=t(22190);let o={critical:"#ef4444",high:"#f97316",medium:"#f59e0b",low:"#3b82f6",info:"#6b7280"};function x(e){let{data:s,height:t=240}=e,x=Object.entries(s).filter(e=>{let[,s]=e;return s>0}).map(e=>{let[s,t]=e;return{name:s.charAt(0).toUpperCase()+s.slice(1),value:t,color:o[s]||"#6b7280"}});return 0===x.length?(0,a.jsx)("div",{className:"flex items-center justify-center text-gray-500 text-sm",style:{height:t},children:"No findings"}):(0,a.jsx)(i.h,{width:"100%",height:t,children:(0,a.jsxs)(r.u,{children:[(0,a.jsx)(n.b,{data:x,cx:"50%",cy:"50%",innerRadius:50,outerRadius:80,paddingAngle:3,dataKey:"value",stroke:"none",children:x.map((e,s)=>(0,a.jsx)(l.b,{fill:e.color},s))}),(0,a.jsx)(d.u,{contentStyle:{backgroundColor:"#1a1a24",border:"1px solid rgba(255,255,255,0.08)",borderRadius:"8px",fontSize:"12px"}}),(0,a.jsx)(c.D,{formatter:e=>(0,a.jsx)("span",{className:"text-xs text-gray-400",children:e})})]})})}},64742:function(e,s,t){"use strict";t.d(s,{h:function(){return c}});var a=t(57437),i=t(2265),r=t(40875),n=t(10407),l=t(30401);let d=(0,t(79205).Z)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);function c(e){let{data:s,defaultExpanded:t=!1,maxHeight:c=400}=e,[o,x]=(0,i.useState)(t),[h,m]=(0,i.useState)(!1),g=JSON.stringify(s,null,2),p=async()=>{await navigator.clipboard.writeText(g),m(!0),setTimeout(()=>m(!1),2e3)};return(0,a.jsxs)("div",{className:"card overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-4 py-2 border-b border-white/[0.06]",children:[(0,a.jsxs)("button",{onClick:()=>x(!o),className:"flex items-center gap-2 text-xs font-medium text-gray-400 hover:text-gray-200",children:[o?(0,a.jsx)(r.Z,{className:"w-3.5 h-3.5"}):(0,a.jsx)(n.Z,{className:"w-3.5 h-3.5"}),"Raw JSON"]}),(0,a.jsx)("button",{onClick:p,className:"btn-ghost p-1.5 text-xs",children:h?(0,a.jsx)(l.Z,{className:"w-3.5 h-3.5 text-green-400"}):(0,a.jsx)(d,{className:"w-3.5 h-3.5"})})]}),o&&(0,a.jsx)("pre",{className:"p-4 text-xs text-gray-400 font-mono overflow-auto",style:{maxHeight:c},children:g})]})}}},function(e){e.O(0,[809,137,324,96,334,382,571,971,117,744],function(){return e(e.s=91951)}),_N_E=e.O()}]);