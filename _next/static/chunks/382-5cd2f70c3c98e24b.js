"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[382],{71837:function(e,t,n){n.d(t,{Aj:function(){return s},FX:function(){return l},IK:function(){return i},Nq:function(){return f},Qx:function(){return b},Rf:function(){return p},bx:function(){return d},h8:function(){return S},hO:function(){return h},iE:function(){return u},lZ:function(){return c},r4:function(){return y},rF:function(){return m},te:function(){return w},x4:function(){return g}});var r=n(65555);async function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((0,r.s6)())return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e.startsWith("/reports/latest")||e.startsWith("/reports/"))return r.j1;if(e.startsWith("/reports"))return[r.j1];if(e.startsWith("/trends"))return r.Zg;if(e.startsWith("/scans/batch")){let e=["https://www.watcho.com"];try{let n=JSON.parse(t.body||"{}");n.urls&&Array.isArray(n.urls)&&(e=n.urls)}catch(e){}let n=e.map((e,t)=>({url:e,scanId:"demo_scan_".concat(String(t+1).padStart(3,"0")),status:"queued"}));return{batchId:"demo_batch",total:e.length,scans:n}}return e.startsWith("/scans")?{status:"queued",scanId:"demo_scan_001"}:e.startsWith("/config")?{schedule:{cron:"0 2 * * *",timezone:"Asia/Kolkata",enabled:!0},thresholds:{overall:95,security:90,performance:95,codeQuality:85},notifications:{slack:{enabled:!1,channel:"#ott"},email:{enabled:!1,recipients:[]},jira:{enabled:!1,projectKey:"OTT",autoCreate:!1}}}:e.startsWith("/webhooks")?[]:e.startsWith("/auth/login")?{token:r.hy,user:{id:"demo",email:"demo@dishtv.in",name:"Demo",role:"admin"}}:e.startsWith("/auth/users")?[{id:"1",email:"admin@dishtv.in",name:"Admin User",role:"admin",is_active:!0,created_at:new Date().toISOString()},{id:"2",email:"devops@dishtv.in",name:"DevOps Engineer",role:"devops",is_active:!0,created_at:new Date().toISOString()}]:e.startsWith("/health")?{status:"demo",uptime:0,timestamp:new Date().toISOString()}:e.startsWith("/jira")?{ticketId:"OTT-DEMO",url:"#"}:{}}(e,t);let n=localStorage.getItem("vzy_token"),o=await fetch("".concat("https://vzy-api-gro1.onrender.com/api").concat(e),{...t,headers:{"Content-Type":"application/json",...n?{Authorization:"Bearer ".concat(n)}:{},...t.headers}});if(!o.ok){let e=await o.json().catch(()=>({error:o.statusText}));throw new a(o.status,e.error||o.statusText)}return o.json()}class a extends Error{constructor(e,t){super(t),this.status=e,this.name="ApiError"}}async function i(e){return o("/reports/latest?target=".concat(encodeURIComponent(e)))}async function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;return o("/trends?target=".concat(encodeURIComponent(e),"&days=").concat(t))}async function c(e){return o("/scans",{method:"POST",body:JSON.stringify(e)})}async function l(e){return o("/scans/batch",{method:"POST",body:JSON.stringify(e)})}async function d(e){return o("/scans/".concat(e,"/abort"),{method:"POST"})}async function u(){return o("/config")}async function m(e){return o("/config",{method:"PATCH",body:JSON.stringify(e)})}async function h(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return o("/webhooks/logs?limit=".concat(e))}async function g(e,t){return o("/auth/login",{method:"POST",body:JSON.stringify({email:e,password:t})})}async function p(){return o("/auth/users")}async function y(e){return o("/auth/users",{method:"POST",body:JSON.stringify(e)})}async function f(e,t){return o("/auth/users/".concat(e),{method:"PUT",body:JSON.stringify(t)})}async function S(e){return o("/auth/users/".concat(e),{method:"DELETE"})}async function b(){return o("/health")}async function w(e){return o("/jira/create",{method:"POST",body:JSON.stringify({findingId:e})})}},65555:function(e,t,n){n.d(t,{Zg:function(){return h},fU:function(){return g},hy:function(){return p},j1:function(){return m},s6:function(){return y}});let r=new Date().toISOString();function o(e,t,n,r,o,a){return{id:e,title:t,description:a,severity:n,category:r,agent:o,location:{url:"https://www.watcho.com"},remediation:"Fix: ".concat(t),autoFixable:!1,references:[]}}function a(e,t,n,r){return{metric:e,value:t,maxScore:n,actualScore:t,penalty:n-t,details:r}}let i=[o("s1","Missing Content-Security-Policy header","high","headers","security","CSP header not set — XSS risk."),o("s2","Missing X-Frame-Options header","medium","headers","security","Page can be embedded in iframes."),o("s3","HSTS max-age below 1 year","medium","headers","security","Strict-Transport-Security too short."),o("s4","Outdated lodash@4.17.15","high","dependencies","security","Prototype pollution CVE-2020-8203."),o("s5","CORS wildcard origin","medium","cors","security","Access-Control-Allow-Origin: *."),o("s6","SSL cert expires in 45 days","low","ssl","security","Renew certificate proactively.")],s=[o("p1","LCP is 3.8s (target <2.5s)","high","core-web-vitals","performance","Largest Contentful Paint too slow."),o("p2","CLS is 0.18 (target <0.1)","medium","core-web-vitals","performance","Layout shift too high."),o("p3","TBT is 450ms (target <200ms)","medium","core-web-vitals","performance","Total Blocking Time too high."),o("p4","Render-blocking CSS","medium","resources","performance","3 CSS files block render."),o("p5","Images not lazy loaded","low","images","performance","Below-fold images load eagerly.")],c=[o("c1","Console.log in production","medium","code-smell","code-quality","12 debug logs found in bundles."),o("c2","35% unused CSS rules","low","code-smell","code-quality","Dead CSS inflates page weight."),o("c3","Missing error boundaries","medium","best-practices","code-quality","No React error boundaries."),o("c4","Bundle size 780KB","low","bundle","code-quality","JS bundle exceeds 500KB.")],l={category:"security",rawScore:72,weight:.4,weightedScore:28.8,breakdown:[a("SSL/TLS Configuration",85,100,"Grade B+ — HSTS needs improvement"),a("Security Headers",55,100,"Missing CSP, Permissions-Policy"),a("CORS Policy",60,100,"Wildcard origin detected"),a("Dependency Vulnerabilities",65,100,"2 known CVEs"),a("DRM/Content Protection",90,100,"Widevine + FairPlay active"),a("Token/Key Exposure",95,100,"No leaks detected"),a("OWASP Compliance",70,100,"A06 flagged")]},d={category:"performance",rawScore:78,weight:.35,weightedScore:27.3,breakdown:[a("Lighthouse Score",74,100,"Overall perf score"),a("Largest Contentful Paint",65,100,"LCP: 3.8s"),a("Cumulative Layout Shift",72,100,"CLS: 0.18"),a("Total Blocking Time",70,100,"TBT: 450ms"),a("First Contentful Paint",88,100,"FCP: 1.2s"),a("Speed Index",82,100,"SI: 2.8s")]},u={category:"code-quality",rawScore:82,weight:.25,weightedScore:20.5,breakdown:[a("Code Smells",75,100,"12 console.log stmts"),a("Best Practices",80,100,"Missing error boundaries"),a("Bundle Analysis",85,100,"780KB gzipped"),a("Accessibility",90,100,"Good ARIA usage"),a("SEO",88,100,"Meta tags present")]},m={id:"report_demo_001",scanId:"demo_scan_001",target:{mode:"url",url:"https://www.watcho.com"},platform:"both",generatedAt:r,agentResults:[{agentType:"security",scanId:"demo_scan_001",status:"completed",startedAt:r,completedAt:r,durationMs:18e5,findings:i,score:l,errors:[],metadata:{sslGrade:"B+",headersScore:55,missingHeaders:["Content-Security-Policy","Permissions-Policy","X-Content-Type-Options"],corsIssues:1,depVulnerabilities:2,drmStatus:{widevine:!0,fairplay:!0,keyRotation:!0},owaspResults:{"A01:2021":{status:"pass",findings:0},"A02:2021":{status:"pass",findings:0},"A03:2021":{status:"warn",findings:1},"A05:2021":{status:"warn",findings:1},"A06:2021":{status:"fail",findings:2},"A09:2021":{status:"warn",findings:1}},sslAnalysis:{grade:"B+",protocol:"TLSv1.3",certExpiry:"2026-04-15",issues:["HSTS too short"],hsts:!0},headerAnalysis:{score:55,missing:["Content-Security-Policy","Permissions-Policy"],misconfigured:[{header:"X-Frame-Options",issue:"SAMEORIGIN set"}],present:["X-XSS-Protection","HSTS"]},corsAnalysis:{allowOrigin:"*",allowCredentials:!1,issues:["Wildcard origin"],wildcardDetected:!0},dependencyVulns:[{package:"lodash",version:"4.17.15",vulnerability:"Prototype Pollution",severity:"high",cveId:"CVE-2020-8203",fixVersion:"4.17.21"}],tokenLeaks:[],drmAnalysis:{widevineDetected:!0,fairplayDetected:!0,licenseUrlExposed:!1,keyRotation:!0,issues:[]}}},{agentType:"performance",scanId:"demo_scan_001",status:"completed",startedAt:r,completedAt:r,durationMs:12e5,findings:s,score:d,errors:[],metadata:{lighthouseScore:74,lcp:3.8,cls:.18,tbt:450,fcp:1.2,si:2.8,tti:4.5,lighthouse:{performanceScore:74,accessibilityScore:88,bestPracticesScore:82,seoScore:90,pwaScore:30},coreWebVitals:{LCP:{value:3.8,rating:"poor"},CLS:{value:.18,rating:"needs-improvement"},FID:{value:85,rating:"good"},INP:{value:210,rating:"needs-improvement"}}}},{agentType:"code-quality",scanId:"demo_scan_001",status:"completed",startedAt:r,completedAt:r,durationMs:9e5,findings:c,score:u,errors:[],metadata:{linesAnalyzed:15420,codeSmells:12,duplicateBlocks:3,complexFunctions:5,bundleSizeKB:780}}],kpiScore:{scanId:"demo_scan_001",timestamp:r,platform:"both",overallScore:76.6,passesThreshold:!1,grades:{security:l,performance:d,codeQuality:u},trend:{direction:"improving",delta:2.3,history:[]},regressions:[]},criticalFindings:[...i,...s].filter(e=>"critical"===e.severity||"high"===e.severity),recommendations:[{priority:1,title:"Add Content-Security-Policy header",description:"Implement strict CSP.",impact:"Prevents XSS attacks",effort:"medium",category:"security"},{priority:2,title:"Optimize LCP",description:"Reduce LCP below 2.5s.",impact:"Better Core Web Vitals",effort:"high",category:"performance"},{priority:3,title:"Update lodash",description:"Upgrade to 4.17.21+.",impact:"Fix prototype pollution",effort:"low",category:"security"},{priority:4,title:"Remove console.log",description:"Strip debug logs.",impact:"Smaller bundle, no data leak",effort:"low",category:"code-quality"}],executiveSummary:"The Watcho OTT platform scores 76.6/100. Key areas: missing CSP header, LCP above threshold, and vulnerable lodash dependency. DRM is well-implemented with Widevine + FairPlay."},h=Array.from({length:14},(e,t)=>({date:new Date(Date.now()-(13-t)*864e5).toISOString(),score:70+10*Math.random(),security:65+15*Math.random(),performance:72+12*Math.random(),codeQuality:78+10*Math.random()})),g={id:"demo-user-001",email:"demo@dishtv.in",name:"Demo User",role:"admin"},p="demo-mode-token";function y(){return localStorage.getItem("vzy_token")===p}},92371:function(e,t,n){n.d(t,{HB:function(){return l},eX:function(){return c},nq:function(){return i},rG:function(){return s},tN:function(){return a}});var r=n(59625),o=n(89134);let a=(0,r.Ue)()((0,o.tJ)((e,t)=>({user:null,token:null,setAuth:(t,n)=>{e({user:t,token:n}),localStorage.setItem("vzy_token",n),document.cookie="vzy_token=".concat(n,"; path=/; max-age=").concat(86400,"; SameSite=Lax")},logout:()=>{e({user:null,token:null}),localStorage.removeItem("vzy_token"),document.cookie="vzy_token=; path=/; max-age=0"},hasRole:e=>{let n=t().user;return!!n&&e.includes(n.role)}}),{name:"vzy-auth"})),i=(0,r.Ue)(e=>({report:null,target:"",loading:!1,error:null,setReport:t=>e({report:t,error:null}),setTarget:t=>e({target:t}),setLoading:t=>e({loading:t}),setError:t=>e({error:t,loading:!1})})),s=(0,r.Ue)((e,t)=>({activeScan:null,scanHistory:[],setActiveScan:t=>e({activeScan:t}),updateAgentProgress:(n,r,o,a)=>{let i=t().activeScan;i&&i.scanId===n&&e({activeScan:{...i,agents:{...i.agents,[r]:{progress:o,status:a}}}})},completeScan:(t,n,r)=>{e(e=>({activeScan:null,scanHistory:[{scanId:t,score:n,status:r,timestamp:new Date().toISOString()},...e.scanHistory.slice(0,49)]}))}})),c=(0,r.Ue)(e=>({batchId:null,batchScans:[],batchRunning:!1,startBatch:(t,n)=>e({batchId:t,batchScans:n.map(e=>({...e,status:"queued"})),batchRunning:!0}),updateBatchEntry:(t,n)=>e(e=>({batchScans:e.batchScans.map(e=>e.scanId===t?{...e,...n}:e)})),clearBatch:()=>e({batchId:null,batchScans:[],batchRunning:!1})})),l=(0,r.Ue)()((0,o.tJ)(e=>({sidebarCollapsed:!1,trendRange:30,toggleSidebar:()=>e(e=>({sidebarCollapsed:!e.sidebarCollapsed})),setTrendRange:t=>e({trendRange:t})}),{name:"vzy-ui"}))}}]);