"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[571],{94022:function(e,t,n){n.d(t,{R:function(){return u}});var r=n(57437),a=n(2265),s=n(40875),c=n(10407),o=n(96362),i=n(95080),l=n(93448);function u(e){let{finding:t,onCreateJira:n}=e,[u,d]=(0,a.useState)(!1);return(0,r.jsxs)("div",{className:"border-b border-white/[0.04] last:border-0",children:[(0,r.jsxs)("button",{onClick:()=>d(!u),className:"w-full flex items-center gap-3 px-4 py-3 text-left hover:bg-white/[0.02] transition-colors",children:[u?(0,r.jsx)(s.Z,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}):(0,r.jsx)(c.Z,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),(0,r.jsx)("span",{className:(0,l.cn)("badge flex-shrink-0",(0,l.pK)(t.severity)),children:t.severity.toUpperCase()}),(0,r.jsx)("span",{className:"text-sm text-gray-200 truncate flex-1",children:t.title}),(0,r.jsx)("span",{className:"text-xs text-gray-500 flex-shrink-0",children:t.category}),t.jiraTicketId&&(0,r.jsx)("span",{className:"text-xs text-brand-400 flex-shrink-0",children:t.jiraTicketId}),t.autoFixable&&(0,r.jsx)("span",{className:"badge bg-cyan-500/15 text-cyan-400 border-cyan-500/30 flex-shrink-0",children:"Auto-fix"})]}),u&&(0,r.jsxs)("div",{className:"px-12 pb-4 space-y-3 animate-fade-up",children:[(0,r.jsx)("p",{className:"text-sm text-gray-300",children:t.description}),t.evidence&&(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-xs font-medium text-gray-500 mb-1",children:"Evidence"}),(0,r.jsx)("pre",{className:"text-xs text-gray-400 bg-surface-1 p-3 rounded-lg overflow-x-auto font-mono",children:t.evidence})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-xs font-medium text-gray-500 mb-1",children:"Remediation"}),(0,r.jsx)("p",{className:"text-sm text-gray-300",children:t.remediation})]}),t.location&&(0,r.jsxs)("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[t.location.file&&(0,r.jsxs)("span",{children:["File: ",(0,l.$G)(t.location.file,60)]}),t.location.line&&(0,r.jsxs)("span",{children:["Line: ",t.location.line]}),t.location.url&&(0,r.jsxs)("span",{children:["URL: ",(0,l.$G)(t.location.url,60)]}),t.location.endpoint&&(0,r.jsxs)("span",{children:["Endpoint: ",t.location.endpoint]})]}),(t.cweId||t.cvssScore)&&(0,r.jsxs)("div",{className:"flex items-center gap-4 text-xs",children:[t.cweId&&(0,r.jsx)("span",{className:"text-gray-400",children:t.cweId}),t.cvssScore&&(0,r.jsxs)("span",{className:(0,l.cn)("font-medium",t.cvssScore>=9?"text-red-400":t.cvssScore>=7?"text-orange-400":"text-amber-400"),children:["CVSS: ",t.cvssScore]})]}),t.references.length>0&&(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:t.references.map((e,t)=>(0,r.jsxs)("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-xs text-brand-400 hover:text-brand-300",children:[(0,r.jsx)(o.Z,{className:"w-3 h-3"})," Reference ",t+1]},t))}),(0,r.jsx)("div",{className:"flex items-center gap-2 pt-2 border-t border-white/[0.04]",children:!t.jiraTicketId&&n&&(0,r.jsxs)("button",{onClick:()=>n(t.id),className:"btn-secondary text-xs py-1.5",children:[(0,r.jsx)(i.Z,{className:"w-3.5 h-3.5"}),"Create Jira Ticket"]})})]})]})}},67437:function(e,t,n){n.d(t,{i:function(){return c}});var r=n(57437),a=n(93448),s=n(10407);function c(e){let{label:t,value:n,subtitle:c,icon:o,trend:i,status:l="neutral",className:u,onClick:d}=e,x=!!d,f=x?"button":"div";return(0,r.jsxs)(f,{onClick:d,className:(0,a.cn)("card p-4 animate-fade-up text-left w-full",x&&"cursor-pointer hover:bg-white/[0.04] hover:border-brand-500/30 transition-all group",u),children:[(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsx)("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:t}),(0,r.jsx)("div",{className:(0,a.cn)("text-2xl font-bold mt-1 tabular-nums","good"===l&&"text-green-400","warn"===l&&"text-amber-400","bad"===l&&"text-red-400","neutral"===l&&"text-gray-100"),children:n}),c&&(0,r.jsx)("div",{className:"text-xs text-gray-500 mt-0.5",children:c})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[o&&(0,r.jsx)("div",{className:(0,a.cn)("p-2 rounded-lg","good"===l&&"bg-green-500/10 text-green-400","warn"===l&&"bg-amber-500/10 text-amber-400","bad"===l&&"bg-red-500/10 text-red-400","neutral"===l&&"bg-white/[0.04] text-gray-400"),children:(0,r.jsx)(o,{className:"w-4 h-4"})}),x&&(0,r.jsx)(s.Z,{className:"w-3.5 h-3.5 text-gray-600 group-hover:text-brand-400 transition-colors"})]})]}),i&&(0,r.jsxs)("div",{className:"mt-3 pt-3 border-t border-white/[0.04] flex items-center gap-1.5",children:[(0,r.jsxs)("span",{className:(0,a.cn)("text-xs font-semibold",i.delta>0?"text-green-400":i.delta<0?"text-red-400":"text-gray-500"),children:[i.delta>0?"+":"",i.delta]}),(0,r.jsx)("span",{className:"text-xs text-gray-500",children:i.label})]}),x&&(0,r.jsx)("div",{className:"mt-2 text-[10px] text-gray-600 group-hover:text-gray-400 transition-colors",children:"Click for details"})]})}},29761:function(e,t,n){n.d(t,{O:function(){return o}});var r=n(57437),a=n(2265),s=n(93448);let c={sm:{width:80,stroke:6,fontSize:"text-lg",labelSize:"text-[10px]"},md:{width:120,stroke:8,fontSize:"text-2xl",labelSize:"text-xs"},lg:{width:180,stroke:10,fontSize:"text-4xl",labelSize:"text-sm"},xl:{width:240,stroke:12,fontSize:"text-5xl",labelSize:"text-base"}};function o(e){let{score:t,label:n,size:o="lg",showStatus:i=!0,animate:l=!0}=e,[u,d]=(0,a.useState)(l?0:t),x=c[o],f=(x.width-x.stroke)/2,h=2*Math.PI*f,g=(0,s.Uc)(t);(0,a.useEffect)(()=>{let e;if(!l){d(t);return}let n=performance.now(),r=a=>{let s=Math.min((a-n)/1200,1);d(Math.round(0+(t-0)*(1-Math.pow(1-s,3)))),s<1&&(e=requestAnimationFrame(r))};return e=requestAnimationFrame(r),()=>cancelAnimationFrame(e)},[t,l]);let m="gauge-gradient-".concat(o,"-").concat(t);return(0,r.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,r.jsxs)("div",{className:"relative",style:{width:x.width,height:x.width},children:[(0,r.jsxs)("svg",{viewBox:"0 0 ".concat(x.width," ").concat(x.width),className:"transform -rotate-90",children:[(0,r.jsx)("defs",{children:(0,r.jsx)("linearGradient",{id:m,x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:t>=95?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("stop",{offset:"0%",stopColor:"#22c55e"}),(0,r.jsx)("stop",{offset:"100%",stopColor:"#4ade80"})]}):t>=80?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("stop",{offset:"0%",stopColor:"#f59e0b"}),(0,r.jsx)("stop",{offset:"100%",stopColor:"#fbbf24"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("stop",{offset:"0%",stopColor:"#ef4444"}),(0,r.jsx)("stop",{offset:"100%",stopColor:"#f87171"})]})})}),(0,r.jsx)("circle",{cx:x.width/2,cy:x.width/2,r:f,fill:"none",stroke:"rgba(255,255,255,0.06)",strokeWidth:x.stroke}),(0,r.jsx)("circle",{cx:x.width/2,cy:x.width/2,r:f,fill:"none",stroke:"url(#".concat(m,")"),strokeWidth:x.stroke,strokeLinecap:"round",strokeDasharray:h,strokeDashoffset:h-u/100*h,className:"gauge-ring"})]}),(0,r.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[(0,r.jsx)("span",{className:(0,s.cn)("font-bold tabular-nums",x.fontSize,(0,s.Uz)(t)),children:u}),n&&(0,r.jsx)("span",{className:(0,s.cn)("text-gray-400 font-medium",x.labelSize),children:n})]})]}),i&&(0,r.jsxs)("div",{className:(0,s.cn)("badge","healthy"===g&&"bg-green-500/15 text-green-400 border-green-500/30","warning"===g&&"bg-amber-500/15 text-amber-400 border-amber-500/30","critical"===g&&"bg-red-500/15 text-red-400 border-red-500/30"),children:[(0,r.jsx)("span",{className:(0,s.cn)("w-1.5 h-1.5 rounded-full","healthy"===g&&"bg-green-400","warning"===g&&"bg-amber-400","critical"===g&&"bg-red-400 animate-pulse")}),"healthy"===g?"Healthy":"warning"===g?"Warning":"Critical"]})]})}},44481:function(e,t,n){n.d(t,{w:function(){return o}});var r=n(2265),a=n(92371),s=n(71837),c=n(79286);function o(){let{report:e,target:t,loading:n,error:o,setReport:i,setTarget:l,setLoading:u,setError:d}=(0,a.nq)(),{activeScan:x,setActiveScan:f,completeScan:h}=(0,a.rG)(),g=(0,r.useCallback)(async()=>{if(t){u(!0);try{let e=await (0,s.IK)(t);i(e)}catch(e){d(e.message)}}},[t,i,u,d]),m=(0,r.useCallback)(async e=>{u(!0);try{let t=await (0,s.lZ)(e);return f({scanId:t.scanId,status:"running",agents:{security:{progress:0,status:"queued"},performance:{progress:0,status:"queued"},"code-quality":{progress:0,status:"queued"},"report-generator":{progress:0,status:"queued"}},startedAt:new Date().toISOString()}),t}catch(e){throw d(e.message),e}},[f,u,d]);(0,r.useEffect)(()=>{let e=(0,c.gN)(e=>{h(e.scanId,e.score,e.status),g()}),t=(0,c.DF)(()=>{f(null),u(!1)});return()=>{e(),t()}},[h,f,g,u]);let p=(null==e?void 0:e.agentResults.find(e=>"security"===e.agentType))||null,b=(null==e?void 0:e.agentResults.find(e=>"performance"===e.agentType))||null,y=(null==e?void 0:e.agentResults.find(e=>"code-quality"===e.agentType))||null,v=((null==e?void 0:e.agentResults.flatMap(e=>e.findings))||[]).reduce((e,t)=>(e[t.severity]=(e[t.severity]||0)+1,e),{});return{report:e,target:t,loading:n,error:o,activeScan:x,securityResult:p,performanceResult:b,codeQualityResult:y,findingsBySeverity:v,setTarget:l,startScan:m,refresh:g}}},71837:function(e,t,n){async function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=localStorage.getItem("vzy_token"),r=await fetch("".concat("https://vzy-api-gro1.onrender.com/api").concat(e),{...t,headers:{"Content-Type":"application/json",...n?{Authorization:"Bearer ".concat(n)}:{},...t.headers}});if(!r.ok){let e=await r.json().catch(()=>({error:r.statusText}));throw new a(r.status,e.error||r.statusText)}return r.json()}n.d(t,{Aj:function(){return c},FX:function(){return i},IK:function(){return s},Nq:function(){return m},Qx:function(){return b},Rf:function(){return h},bx:function(){return l},h8:function(){return p},hO:function(){return x},iE:function(){return u},lZ:function(){return o},r4:function(){return g},rF:function(){return d},te:function(){return y},x4:function(){return f}});class a extends Error{constructor(e,t){super(t),this.status=e,this.name="ApiError"}}async function s(e){return r("/reports/latest?target=".concat(encodeURIComponent(e)))}async function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;return r("/trends?target=".concat(encodeURIComponent(e),"&days=").concat(t))}async function o(e){return r("/scans",{method:"POST",body:JSON.stringify(e)})}async function i(e){return r("/scans/batch",{method:"POST",body:JSON.stringify(e)})}async function l(e){return r("/scans/".concat(e,"/abort"),{method:"POST"})}async function u(){return r("/config")}async function d(e){return r("/config",{method:"PATCH",body:JSON.stringify(e)})}async function x(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return r("/webhooks/logs?limit=".concat(e))}async function f(e,t){return r("/auth/login",{method:"POST",body:JSON.stringify({email:e,password:t})})}async function h(){return r("/auth/users")}async function g(e){return r("/auth/users",{method:"POST",body:JSON.stringify(e)})}async function m(e,t){return r("/auth/users/".concat(e),{method:"PUT",body:JSON.stringify(t)})}async function p(e){return r("/auth/users/".concat(e),{method:"DELETE"})}async function b(){return r("/health")}async function y(e){return r("/jira/create",{method:"POST",body:JSON.stringify({findingId:e})})}},92371:function(e,t,n){n.d(t,{HB:function(){return l},eX:function(){return i},nq:function(){return c},rG:function(){return o},tN:function(){return s}});var r=n(59625),a=n(89134);let s=(0,r.Ue)()((0,a.tJ)((e,t)=>({user:null,token:null,setAuth:(t,n)=>{e({user:t,token:n}),localStorage.setItem("vzy_token",n),document.cookie="vzy_token=".concat(n,"; path=/; max-age=").concat(86400,"; SameSite=Lax")},logout:()=>{e({user:null,token:null}),localStorage.removeItem("vzy_token"),document.cookie="vzy_token=; path=/; max-age=0"},hasRole:e=>{let n=t().user;return!!n&&e.includes(n.role)}}),{name:"vzy-auth"})),c=(0,r.Ue)(e=>({report:null,target:"",loading:!1,error:null,setReport:t=>e({report:t,error:null}),setTarget:t=>e({target:t}),setLoading:t=>e({loading:t}),setError:t=>e({error:t,loading:!1})})),o=(0,r.Ue)((e,t)=>({activeScan:null,scanHistory:[],setActiveScan:t=>e({activeScan:t}),updateAgentProgress:(n,r,a,s)=>{let c=t().activeScan;c&&c.scanId===n&&e({activeScan:{...c,agents:{...c.agents,[r]:{progress:a,status:s}}}})},completeScan:(t,n,r)=>{e(e=>({activeScan:null,scanHistory:[{scanId:t,score:n,status:r,timestamp:new Date().toISOString()},...e.scanHistory.slice(0,49)]}))}})),i=(0,r.Ue)(e=>({batchId:null,batchScans:[],batchRunning:!1,startBatch:(t,n)=>e({batchId:t,batchScans:n.map(e=>({...e,status:"queued"})),batchRunning:!0}),updateBatchEntry:(t,n)=>e(e=>({batchScans:e.batchScans.map(e=>e.scanId===t?{...e,...n}:e)})),clearBatch:()=>e({batchId:null,batchScans:[],batchRunning:!1})})),l=(0,r.Ue)()((0,a.tJ)(e=>({sidebarCollapsed:!1,trendRange:30,toggleSidebar:()=>e(e=>({sidebarCollapsed:!e.sidebarCollapsed})),setTrendRange:t=>e({trendRange:t})}),{name:"vzy-ui"}))},93448:function(e,t,n){n.d(t,{$G:function(){return x},Sy:function(){return d},Uc:function(){return c},Uz:function(){return o},cn:function(){return s},dH:function(){return u},pK:function(){return i},td:function(){return l}});var r=n(61994),a=n(53335);function s(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,a.m6)((0,r.W)(t))}function c(e){return e>=95?"healthy":e>=80?"warning":"critical"}function o(e){return e>=95?"text-kpi-pass":e>=80?"text-kpi-warn":"text-kpi-fail"}function i(e){return({critical:"bg-red-500/15 text-red-400 border-red-500/30",high:"bg-orange-500/15 text-orange-400 border-orange-500/30",medium:"bg-amber-500/15 text-amber-400 border-amber-500/30",low:"bg-blue-500/15 text-blue-400 border-blue-500/30",info:"bg-gray-500/15 text-gray-400 border-gray-500/30"})[e]}function l(e){if(0===e)return"0 B";let t=Math.floor(Math.log(e)/Math.log(1024));return"".concat(parseFloat((e/Math.pow(1024,t)).toFixed(1))," ").concat(["B","KB","MB","GB"][t])}function u(e){return e<1e3?"".concat(Math.round(e),"ms"):"".concat((e/1e3).toFixed(1),"s")}function d(e){let t="string"==typeof e?new Date(e):e,n=Math.floor((Date.now()-t.getTime())/6e4);if(n<1)return"just now";if(n<60)return"".concat(n,"m ago");let r=Math.floor(n/60);return r<24?"".concat(r,"h ago"):"".concat(Math.floor(r/24),"d ago")}function x(e,t){return e.length<=t?e:e.slice(0,t)+"..."}},79286:function(e,t,n){n.d(t,{$j:function(){return o},DF:function(){return u},H0:function(){return d},WH:function(){return x},gN:function(){return l},zP:function(){return i}});var r=n(68680);let a=n(40257).env.WS_URL||"https://vzy-api-gro1.onrender.com",s=null,c={"scan:progress":new Set,"scan:complete":new Set,"scan:error":new Set,"batch:progress":new Set,"batch:complete":new Set};function o(){return(null==s?void 0:s.connected)||((s=(0,r.io)(a,{transports:["websocket","polling"],reconnection:!0,reconnectionDelay:2e3,reconnectionAttempts:10,auth:{token:localStorage.getItem("vzy_token")}})).on("connect",()=>{console.info("[WS] Connected:",null==s?void 0:s.id)}),s.on("disconnect",e=>{console.warn("[WS] Disconnected:",e)}),s.on("scan:progress",e=>{c["scan:progress"].forEach(t=>t(e))}),s.on("scan:complete",e=>{c["scan:complete"].forEach(t=>t(e))}),s.on("scan:error",e=>{c["scan:error"].forEach(t=>t(e))}),s.on("batch:progress",e=>{c["batch:progress"].forEach(t=>t(e))}),s.on("batch:complete",e=>{c["batch:complete"].forEach(t=>t(e))})),s}function i(){null==s||s.disconnect(),s=null}function l(e){return c["scan:complete"].add(e),()=>{c["scan:complete"].delete(e)}}function u(e){return c["scan:error"].add(e),()=>{c["scan:error"].delete(e)}}function d(e){return c["batch:progress"].add(e),()=>{c["batch:progress"].delete(e)}}function x(e){return c["batch:complete"].add(e),()=>{c["batch:complete"].delete(e)}}}}]);